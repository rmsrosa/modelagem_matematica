<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Séries de Fourier e compressão de audio</title>  
  <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/css/base.css"/>
  
  <script src="/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/libs/highlight/github.min.css">
    <script src="/libs/highlight/highlight.pack.js"></script>
    <script src="/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Modelos em Eletrônica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c08/0801-Modelo_diodo">8.1. Modelagem da relação voltagem-corrente de um diodo</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Reações Químicas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c09/0901-Lei_acao_de_massas">9.1. Lei de ação de massas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c09/0902-Reacoes_enzimaticas">9.2. Modelagem de reações enzimática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c09/0903-Isomerizacao">9.3. Lupulagem e a conversão de humulone em iso-humulone considerando saturação</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Modelos Epidemiológicos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c10/1001-Modelos_epidemiologicos_compartimentais">10.1. Modelos epidemiológicos compartimentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c10/1002-Ajuste_SIR">10.2. Ajustando um modelo SIR a uma epidemia de Influenza</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Séries de Fourier e Aplicações</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c11/1102-Transformada_discreta_Fourier">11.2. Transformada discreta de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais <kbd>←</kbd></a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c11/1104-Compressao_audio.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c11/1104-Compressao_audio.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/generated/jupytered/c11/1104-Compressao_audio.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/src/jupyter/c11/1104-Compressao_audio.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1 id="get_title"><a href="#get_title" class="header-anchor">11.4. Séries de Fourier e compressão de audio</a></h1>
<pre><code class="language-julia">using LinearAlgebra
using Plots
using WAV
using FFTW</code></pre>
<pre><code class="language-julia">filepath &#61; &quot;../../../_assets/attachments/data/audio/piano-phrase.wav&quot;
fr, frs &#61; wavread&#40;filepath&#41;
tempos &#61; &#40;0:size&#40;fr&#41;&#91;1&#93;-1&#41;./frs</code></pre>
<pre><code class="language-julia">0.0f0:2.2675737f-5:3.8457823f0</code></pre>
<pre><code class="language-julia">WAVArray&#40;frs, fr, &quot;Frase de piano&quot;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 2&#125;&#40;44100.0f0, &#91;-0.004272591326639607; -0.004272591326
639607; … ; -0.0037537766655476546; -0.0038453321939756462;;&#93;, &quot;Frase de pi
ano&quot;&#41;</code></pre>
<pre><code class="language-julia">display&#40;plot&#40;tempos, fr&#91;:,1&#93;, xlabel&#61;&quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Sinal sonoro&quot;, titlefont&#61;10&#41;&#41;</code></pre>
<img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_4_1.png" alt="">
<pre><code class="language-julia">println&#40;&quot;Duração: &#36;&#40;length&#40;fr&#41;/frs&#41; s&quot;&#41;</code></pre>
<pre><code class="language-julia">Duração: 3.845805 s</code></pre>
<pre><code class="language-julia">frame_duration &#61; 100 # ms - padrão mp3 é de 26 ms
frame_length &#61; Int&#40;div&#40;frame_duration * frs, 1000&#41;&#41;
fr_frame &#61; fr&#91;1:frame_length, 1&#93;</code></pre>
<pre><code class="language-julia">4410-element Vector&#123;Float64&#125;:
 -0.004272591326639607
 -0.004272591326639607
 -0.004272591326639607
 -0.004394665364543596
 -0.004150517288735618
 -0.003906369212927641
 -0.004150517288735618
 -0.0045167394024475845
 -0.004394665364543596
 -0.004272591326639607
  ⋮
  0.2216864528336436
  0.20789208655049288
  0.17896053956724753
  0.1497848445081942
  0.13623462630085148
  0.14087343974120303
  0.15601062044129765
  0.17371135593737602
  0.19104586931974243</code></pre>
<pre><code class="language-julia">WAVArray&#40;frs, fr_frame, &quot;Frase de piano &#40;primeiros &#36;&#40;frame_duration&#41;ms&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 1&#125;&#40;44100.0f0, &#91;-0.004272591326639607, -0.004272591326
639607, -0.004272591326639607, -0.004394665364543596, -0.004150517288735618
, -0.003906369212927641, -0.004150517288735618, -0.0045167394024475845, -0.
004394665364543596, -0.004272591326639607  …  0.21472823267311625, 0.221686
4528336436, 0.20789208655049288, 0.17896053956724753, 0.1497848445081942, 0
.13623462630085148, 0.14087343974120303, 0.15601062044129765, 0.17371135593
737602, 0.19104586931974243&#93;, &quot;Frase de piano &#40;primeiros 100ms&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">tempos_frame &#61; &#40;0:length&#40;fr_frame&#41;-1&#41; / frs
freqs_frame &#61; &#40;0:div&#40;frame_length, 2&#41;&#41; / frs # frequências
fr_frame_hat &#61; rfft&#40;fr_frame&#41;
Z_frame &#61; &#91;
    abs&#40;fr_frame_hat&#91;1&#93;&#41; / frame_length; 
    2abs.&#40;fr_frame_hat&#91;2:end&#93;&#41; / frame_length
&#93;

display&#40;WAVArray&#40;frs, fr_frame, &quot;Parte da frase de piano&quot;&#41;&#41;

display&#40;plot&#40;tempos_frame, fr_frame, xlabel&#61;&quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Sinal do canal 1&quot;, titlefont&#61;10&#41;&#41;
display&#40;plot&#40;freqs_frame, Z_frame, xlabel&#61;&quot;frequências &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Espectro de amplitude&quot;, titlefont&#61;10&#41;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 1&#125;&#40;44100.0f0, &#91;-0.004272591326639607, -0.004272591326
639607, -0.004272591326639607, -0.004394665364543596, -0.004150517288735618
, -0.003906369212927641, -0.004150517288735618, -0.0045167394024475845, -0.
004394665364543596, -0.004272591326639607  …  0.21472823267311625, 0.221686
4528336436, 0.20789208655049288, 0.17896053956724753, 0.1497848445081942, 0
.13623462630085148, 0.14087343974120303, 0.15601062044129765, 0.17371135593
737602, 0.19104586931974243&#93;, &quot;Parte da frase de piano&quot;&#41;</code></pre>
<p><img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_8_1.png" alt=""> <img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_8_2.png" alt=""></p>
<pre><code class="language-julia">fr_frame_hat</code></pre>
<pre><code class="language-julia">2206-element Vector&#123;ComplexF64&#125;:
  -11.404889065218056 &#43; 0.0im
    4.401345761508306 &#43; 0.08595490000528298im
   3.4082877653630614 &#43; 0.08196426411445865im
    6.356587472128002 - 0.18964797651701643im
    4.869113461640563 - 3.5923118212833742im
    8.323783990508698 &#43; 3.2490025667385174im
   3.8612916512226567 &#43; 0.8364064885072844im
   7.5179312978981425 - 2.3330276269850465im
    8.227964101740415 &#43; 4.175612138713387im
    8.424895602709034 &#43; 4.742851933641199im
                      ⋮
 -0.09795696005902577 - 0.0027981825930214477im
 -0.09975011408390433 &#43; 0.003312592743423881im
 -0.09948480393847481 - 0.0011974075667288142im
 -0.10341372301687057 - 0.0004984029279813118im
 -0.09738611974973593 &#43; 0.0048997456655905935im
 -0.10414685693085268 - 0.0002215345564245963im
 -0.09299656851336868 - 0.0017714270969930584im
 -0.10644238614362234 &#43; 0.005858871159521911im
 -0.10205389568773549 &#43; 0.0im</code></pre>
<pre><code class="language-julia">Z_frame</code></pre>
<pre><code class="language-julia">2206-element Vector&#123;Float64&#125;:
 0.0025861426451741624
 0.00199645578143504
 0.0015461556382688974
 0.0028840888455569837
 0.002744156570342591
 0.004052336221113851
 0.0017917648796805968
 0.0035698930264991334
 0.004184521541841969
 0.004384657578361314
 ⋮
 4.4443046509158166e-5
 4.5263085137162955e-5
 4.512109284680357e-5
 4.690019230727104e-5
 4.422190532236617e-5
 4.723224151822258e-5
 4.218296522720364e-5
 4.834626217683909e-5
 4.628294589012947e-5</code></pre>
<pre><code class="language-julia">&#91;eachindex&#40;Z_frame&#41; Z_frame&#93;</code></pre>
<pre><code class="language-julia">2206×2 Matrix&#123;Float64&#125;:
    1.0  0.00258614
    2.0  0.00199646
    3.0  0.00154616
    4.0  0.00288409
    5.0  0.00274416
    6.0  0.00405234
    7.0  0.00179176
    8.0  0.00356989
    9.0  0.00418452
   10.0  0.00438466
    ⋮    
 2198.0  4.4443e-5
 2199.0  4.52631e-5
 2200.0  4.51211e-5
 2201.0  4.69002e-5
 2202.0  4.42219e-5
 2203.0  4.72322e-5
 2204.0  4.2183e-5
 2205.0  4.83463e-5
 2206.0  4.62829e-5</code></pre>
<pre><code class="language-julia">Z_frame_top &#61; sortslices&#40;&#91;eachindex&#40;Z_frame&#41; Z_frame&#93;, dims &#61; 1, by &#61; x -&gt; x&#91;2&#93;, rev &#61; true&#41;</code></pre>
<pre><code class="language-julia">2206×2 Matrix&#123;Float64&#125;:
   84.0  0.0599791
   83.0  0.0526109
  201.0  0.0472486
  117.0  0.0403817
  200.0  0.0388048
   34.0  0.0346802
  252.0  0.0297227
  118.0  0.0286083
   28.0  0.0285721
   85.0  0.0281542
    ⋮    
  835.0  1.38591e-5
 1018.0  1.30356e-5
  998.0  1.25695e-5
 1105.0  1.25672e-5
 1000.0  8.86168e-6
 1110.0  7.37743e-6
  975.0  6.53743e-6
  979.0  5.19717e-6
  896.0  4.84732e-6</code></pre>
<pre><code class="language-julia">scatter&#40;Z_frame_top&#91;:,2&#93;&#41;</code></pre>
<img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_13_1.png" alt="">
<pre><code class="language-julia">length_top &#61; 10
Z_top_inds &#61; Int.&#40;Z_frame_top&#91;1:length_top, 1&#93;&#41;</code></pre>
<pre><code class="language-julia">10-element Vector&#123;Int64&#125;:
  84
  83
 201
 117
 200
  34
 252
 118
  28
  85</code></pre>
<pre><code class="language-julia"># need to specify length of inverse real transform since the rfft is &#91;d/2&#93; long
# and the inverse could be 2&#91;d/2&#93; or 2&#91;d/2&#93; &#43; 1, depending on whether the original
# vector has even or odd length
irfft&#40;rfft&#40;fr_frame&#41;, frame_length&#41; ≈ fr_frame</code></pre>
<pre><code class="language-julia">true</code></pre>
<pre><code class="language-julia">irfft&#40;fr_frame_hat, frame_length&#41;</code></pre>
<pre><code class="language-julia">4410-element Vector&#123;Float64&#125;:
 -0.00427259132663957
 -0.004272591326639584
 -0.004272591326639647
 -0.004394665364543561
 -0.0041505172887356554
 -0.00390636921292764
 -0.004150517288735565
 -0.0045167394024476434
 -0.004394665364543606
 -0.004272591326639615
  ⋮
  0.22168645283364358
  0.2078920865504928
  0.1789605395672476
  0.14978484450819404
  0.13623462630085148
  0.14087343974120303
  0.1560106204412977
  0.17371135593737597
  0.1910458693197424</code></pre>
<pre><code class="language-julia">fr_frame_hat_top &#61; zero&#40;fr_frame_hat&#41;</code></pre>
<pre><code class="language-julia">2206-element Vector&#123;ComplexF64&#125;:
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
     ⋮
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im
 0.0 &#43; 0.0im</code></pre>
<pre><code class="language-julia">fr_frame_hat_top&#91;Z_top_inds&#93; .&#61; fr_frame_hat&#91;Z_top_inds&#93;</code></pre>
<pre><code class="language-julia">10-element view&#40;::Vector&#123;ComplexF64&#125;, &#91;84, 83, 201, 117, 200, 34, 252, 118,
 28, 85&#93;&#41; with eltype ComplexF64:
  -33.7650251711755 &#43; 127.8710499762217im
 108.41005282342019 &#43; 41.290164676220094im
 47.289120719299596 - 92.83249405927802im
  87.41383980697884 - 16.948297321524063im
 -77.03232742431845 - 37.246795014039236im
  38.90968266012985 &#43; 65.83057114989343im
  63.96465597470014 - 14.276368846574574im
   10.3165556316061 &#43; 62.23208374945314im
  61.86100665910691 - 11.933514499402161im
 -61.50572488024286 - 8.42433607287688im</code></pre>
<pre><code class="language-julia">fr_frame_top &#61; irfft&#40;fr_frame_hat_top, frame_length&#41;</code></pre>
<pre><code class="language-julia">4410-element Vector&#123;Float64&#125;:
  0.11150196680249652
  0.11516766061405592
  0.11368059086290214
  0.10637386031287596
  0.09315763965670329
  0.07450428034735375
  0.05137454324737221
  0.02509723558159485
 -0.0027807386079490206
 -0.03065452950203258
  ⋮
  0.09465256693964458
  0.08038808658361979
  0.07101057618668619
  0.06709023634234279
  0.06848536640942049
  0.07438762259453545
  0.08343888439499116
  0.09390397105741916
  0.10387772808735343</code></pre>
<pre><code class="language-julia">freqs_frame &#61; &#40;0:div&#40;frame_length, 2&#41;&#41; / frs # frequências
fr_frame_top_hat &#61; rfft&#40;fr_frame&#41;
Z_frame_top_back &#61; &#91;
    abs&#40;fr_frame_top_hat&#91;1&#93;&#41; / frame_length; 
    2abs.&#40;fr_frame_top_hat&#91;2:end&#93;&#41; / frame_length
&#93;

display&#40;WAVArray&#40;frs, fr_frame_top, &quot;Parte da frase de piano comprimida&quot;&#41;&#41;

display&#40;plot&#40;tempos_frame, fr_frame_top, xlabel&#61;&quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Sinal do canal 1&quot;, titlefont&#61;10&#41;&#41;
display&#40;plot&#40;freqs_frame, Z_frame_top_back, xlabel&#61;&quot;frequências &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Espectro de amplitude&quot;, titlefont&#61;10&#41;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 1&#125;&#40;44100.0f0, &#91;0.11150196680249652, 0.115167660614055
92, 0.11368059086290214, 0.10637386031287596, 0.09315763965670329, 0.074504
28034735375, 0.05137454324737221, 0.02509723558159485, -0.00278073860794902
06, -0.03065452950203258  …  0.11255622795344103, 0.09465256693964458, 0.08
038808658361979, 0.07101057618668619, 0.06709023634234279, 0.06848536640942
049, 0.07438762259453545, 0.08343888439499116, 0.09390397105741916, 0.10387
772808735343&#93;, &quot;Parte da frase de piano comprimida&quot;&#41;</code></pre>
<p><img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_20_1.png" alt=""> <img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_20_2.png" alt=""></p>
<pre><code class="language-julia">display&#40;WAVArray&#40;frs, fr_frame, &quot;Parte da frase de piano&quot;&#41;&#41;

display&#40;plot&#40;tempos_frame, fr_frame, xlabel&#61;&quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Sinal do canal 1&quot;, titlefont&#61;10&#41;&#41;
display&#40;plot&#40;freqs_frame, Z_frame, xlabel&#61;&quot;frequências &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing,
    title&#61;&quot;Espectro de amplitude&quot;, titlefont&#61;10&#41;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 1&#125;&#40;44100.0f0, &#91;-0.004272591326639607, -0.004272591326
639607, -0.004272591326639607, -0.004394665364543596, -0.004150517288735618
, -0.003906369212927641, -0.004150517288735618, -0.0045167394024475845, -0.
004394665364543596, -0.004272591326639607  …  0.21472823267311625, 0.221686
4528336436, 0.20789208655049288, 0.17896053956724753, 0.1497848445081942, 0
.13623462630085148, 0.14087343974120303, 0.15601062044129765, 0.17371135593
737602, 0.19104586931974243&#93;, &quot;Parte da frase de piano&quot;&#41;</code></pre>
<p><img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_21_1.png" alt=""> <img src="/assets/pages/jupytered/c11/1104-Compressao_audio/code/images/1104-Compressao_audio_21_2.png" alt=""></p>
<pre><code class="language-julia">function compress_frame&#40;fr_frame, frs, length_top &#61; 50&#41;
    frame_length &#61; length&#40;fr_frame&#41;
    # tempos_frame &#61; &#40; 0 : frame_length - 1 &#41; / frs
    freqs_frame &#61; &#40;0 : div&#40;frame_length, 2&#41;&#41; / frs # frequências
    fr_frame_hat &#61; rfft&#40;fr_frame&#41;
    Z_frame &#61; &#91;
        abs&#40;fr_frame_hat&#91;1&#93;&#41; / frame_length; 
        2abs.&#40;fr_frame_hat&#91;2:end&#93;&#41; / frame_length
    &#93;
    Z_frame_top &#61; sortslices&#40;&#91;eachindex&#40;Z_frame&#41; Z_frame&#93;, dims &#61; 1, by &#61; x -&gt; x&#91;2&#93;, rev &#61; true&#41;
    Z_top_inds &#61; Int.&#40;Z_frame_top&#91;1:length_top, 1&#93;&#41;
    fr_frame_hat_top &#61; zero&#40;fr_frame_hat&#41;
    fr_frame_hat_top&#91;Z_top_inds&#93; .&#61; fr_frame_hat&#91;Z_top_inds&#93;
    return &#40;
        inds &#61; Z_top_inds,
        freqs &#61; fr_frame_hat&#91;Z_top_inds&#93;,
    &#41;
end

function uncompress_frame&#40;inds, freqs, frame_length&#41;
    fr_frame_hat_top &#61; zeros&#40;ComplexF64, div&#40;frame_length, 2&#41; &#43; 1&#41;
    fr_frame_hat_top&#91;inds&#93; .&#61; freqs
    fr_frame_back &#61; irfft&#40;fr_frame_hat_top, frame_length&#41;
    return fr_frame_back
end</code></pre>
<pre><code class="language-julia">uncompress_frame &#40;generic function with 1 method&#41;</code></pre>
<pre><code class="language-julia">comp &#61; compress_frame&#40;fr_frame, frs&#41;</code></pre>
<pre><code class="language-julia">&#40;inds &#61; &#91;84, 83, 201, 117, 200, 34, 252, 118, 28, 85  …  250, 149, 38, 184,
 52, 12, 87, 80, 13, 199&#93;, freqs &#61; ComplexF64&#91;-33.7650251711755 &#43; 127.87104
99762217im, 108.41005282342019 &#43; 41.290164676220094im, 47.289120719299596 -
 92.83249405927802im, 87.41383980697884 - 16.948297321524063im, -77.0323274
2431845 - 37.246795014039236im, 38.90968266012985 &#43; 65.83057114989343im, 63
.96465597470014 - 14.276368846574574im, 10.3165556316061 &#43; 62.2320837494531
4im, 61.86100665910691 - 11.933514499402161im, -61.50572488024286 - 8.42433
607287688im  …  -1.5763830555113825 - 26.78384302022884im, 25.9035319678887
46 - 5.098261475424842im, -13.390624767147212 - 21.70999974515257im, 17.801
332197848172 &#43; 18.00447646320448im, -14.644280862638023 - 20.64103380445097
7im, -7.686096144051215 &#43; 22.207414433972165im, -22.74665240232254 - 4.2549
79491656448im, 8.768875950052678 - 19.891876336588567im, 7.732962888637599 
- 19.993290844392874im, -8.32520479424382 &#43; 19.273903426153318im&#93;&#41;</code></pre>
<pre><code class="language-julia">fr_frame_bak &#61; uncompress_frame&#40;comp.inds, comp.freqs, frame_length&#41;</code></pre>
<pre><code class="language-julia">4410-element Vector&#123;Float64&#125;:
  0.12204643788761159
  0.11851994936975584
  0.11077768425394953
  0.09853635305203902
  0.08198994752532585
  0.061800262610382094
  0.039030251100656194
  0.015029397447569462
 -0.008713844757604408
 -0.030733682579983965
  ⋮
  0.11803899901224801
  0.1132353841973656
  0.10990532262619378
  0.10862157921677112
  0.10949925216054505
  0.1121862270524816
  0.1159167139641682
  0.11961978742660018
  0.12206801454800163</code></pre>
<pre><code class="language-julia">display&#40;WAVArray&#40;frs, fr_frame_bak, &quot;compressed audio&quot;&#41;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 1&#125;&#40;44100.0f0, &#91;0.12204643788761159, 0.118519949369755
84, 0.11077768425394953, 0.09853635305203902, 0.08198994752532585, 0.061800
262610382094, 0.039030251100656194, 0.015029397447569462, -0.00871384475760
4408, -0.030733682579983965  …  0.12335843470416524, 0.11803899901224801, 0
.1132353841973656, 0.10990532262619378, 0.10862157921677112, 0.109499252160
54505, 0.1121862270524816, 0.1159167139641682, 0.11961978742660018, 0.12206
801454800163&#93;, &quot;compressed audio&quot;&#41;</code></pre>
<pre><code class="language-julia">frame_duration &#61; 26 # ms - padrão mp3 é de 26 ms
frame_length &#61; Int&#40;div&#40;frame_duration * frs, 1000&#41;&#41;</code></pre>
<pre><code class="language-julia">1146</code></pre>
<pre><code class="language-julia">uncomp &#61; Array&#123;Float64, 2&#125;&#40;undef, div&#40;length&#40;fr&#41;, frame_length&#41; * frame_length, 1&#41;
for n in 1:div&#40;length&#40;fr&#41;, frame_length&#41;
    nstart &#61; &#40; n - 1 &#41; * frame_length &#43; 1
    nend &#61; n * frame_length
    lfr_frame &#61; fr&#91;nstart:nend, 1&#93;
    comp_frame &#61; compress_frame&#40;lfr_frame, frs, 50&#41;
    uncomp_frame &#61; uncompress_frame&#40;comp_frame.inds, comp_frame.freqs, length&#40;lfr_frame&#41;&#41;
    uncomp&#91;nstart:nend, 1&#93; .&#61; uncomp_frame
end</code></pre>
<pre><code class="language-julia">display&#40;WAVArray&#40;frs, uncomp, &quot;compressed audio&quot;&#41;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 2&#125;&#40;44100.0f0, &#91;-0.0007923241279948214; -0.00153024020
11201565; … ; -0.005413102257079467; -0.006042595345009632;;&#93;, &quot;compressed 
audio&quot;&#41;</code></pre>
<pre><code class="language-julia">display&#40;WAVArray&#40;frs, fr, &quot;Frase de piano&quot;&#41;&#41;</code></pre>
<pre><code class="language-julia">WAV.WAVArray&#123;Float64, 2&#125;&#40;44100.0f0, &#91;-0.004272591326639607; -0.004272591326
639607; … ; -0.0037537766655476546; -0.0038453321939756462;;&#93;, &quot;Frase de pi
ano&quot;&#41;</code></pre>
<h2 id="referências"><a href="#referências" class="header-anchor">Referências</a></h2>
<ol>
<li><p><a href="http://www.mp3-tech.org/programmer/docs/mp3_theory.pdf">Rassol Raissi, The theory behind MP3, dez/2002</a></p>
</li>
<li><p><a href="https://webdocs.cs.ualberta.ca/~c603/latex/LaTeX_docs/article2/oggVorbis.pdf">A. Carlacci, Ogg Vorbis and MP3 Audio Stream charecterization</a></p>
</li>
</ol>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais <kbd>←</kbd></a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: July 05, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    

    
        <script src="/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
