<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Transformada discreta de Fourier</title>  
  <link rel="shortcut icon" type="image/png" href="/modelagem_matematica/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/modelagem_matematica/css/base.css"/>
  
  <script src="/modelagem_matematica/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/highlight/github.min.css">
    <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
    <script src="/modelagem_matematica/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/modelagem_matematica/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Modelos em Eletrônica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c08/0801-Modelo_diodo">8.1. Modelagem da relação voltagem-corrente de um diodo</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Reações Químicas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0901-Lei_acao_de_massas">9.1. Lei de ação de massas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0902-Reacoes_enzimaticas">9.2. Modelagem de reações enzimática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0903-Isomerizacao">9.3. Lupulagem e a conversão de humulone em iso-humulone considerando saturação</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Modelos Epidemiológicos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1001-Modelos_epidemiologicos_compartimentais">10.1. Modelos epidemiológicos compartimentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1002-Ajuste_SIR">10.2. Ajustando um modelo SIR a uma epidemia de Influenza</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1004-Individual_estocastico">10.4. Modelos individuais</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Séries de Fourier e Aplicações</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1102-Transformada_discreta_Fourier">11.2. Transformada discreta de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/modelagem_matematica/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais"><kbd>→</kbd> 11.3. Ondas sonoras e elementos musicais</a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c11/1102-Transformada_discreta_Fourier.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c11/1102-Transformada_discreta_Fourier.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/modelagem_matematica/generated/jupytered/c11/1102-Transformada_discreta_Fourier.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/modelagem_matematica/src/jupyter/c11/1102-Transformada_discreta_Fourier.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1 id="get_title"><a href="#get_title" class="header-anchor">11.2. Transformada discreta de Fourier</a></h1>
<pre><code class="language-julia">using LinearAlgebra
using Plots
using FFTW
using Random</code></pre>
<h2 id="transformada_discreta_de_fourier"><a href="#transformada_discreta_de_fourier" class="header-anchor">Transformada discreta de Fourier</a></h2>
<ul>
<li><p>A transformada discreta de Fourier é uma versão da série de Fourier para vetores.</p>
</li>
<li><p>Nesse caso, o vetor é interpretado como uma informação digital colhida a intervalos iguais.</p>
</li>
<li><p>Por exemplo, o vetor pode representar um sinal de áudio, um sinal de um sismograma, pixels de uma imagem, etc.</p>
</li>
<li><p>Dado, então, um vetor \(x = (x_n)_{n=0}^{N-1}\), onde \(N\in \mathbb{N}\) e onde \(x_n\) pode ser real ou complexo, a sua <strong>transformada discreta de Fourier</strong> é um novo vetor, complexo, \(X = (X_k)_k\) dado por</p>
</li>
</ul>
\[ X_k = \sum_{n=0}^{N-1} x_n e^{\frac{-2\pi i kn}{N}} = \sum_{n=0}^{N-1} x_n \left(\cos\left(\frac{2\pi kn}{N} \right) - i \sin\left(\frac{2\pi kn}{N}\right) \right).
\]
<ul>
<li><p>A transformada inversa é dada por</p>
</li>
</ul>
\[ x_n = \frac{1}{N}\sum_{k=0}^{N-1} X_k e^{\frac{2\pi i nk}{N}}.
\]
<h3 id="simetria_no_caso_real"><a href="#simetria_no_caso_real" class="header-anchor">Simetria no caso real</a></h3>
<ul>
<li><p>No caso em que o sinal \(x=(x_n)_{n=0}^{N-1}\) é real, temos, para \(k=1, \ldots, N-1\),</p>
</li>
</ul>
\[ \begin{align*}
  X_{N-k} & = \sum_{n=0}^{N-1} x_n e^{\frac{-2\pi i (N-k)n}{N}} = \sum_{n=0}^{N-1} x_n e^{-2\pi i n}e^{\frac{2\pi i kn}{N}} = \sum_{n=0}^{N-1} x_n e^{\frac{2\pi i kn}{N}} \\
& = \sum_{n=0}^{N-1} \overline{x_n e^{\frac{-2\pi i kn}{N}}} = \overline{\sum_{n=0}^{N-1} x_n e^{\frac{-2\pi i k n}{N}}} = \overline{X_k}.
\end{align*}
\]
<ul>
<li><p>Ou seja, \(X_{N-k}\) é o complexo conjugado de \(X_k\), para \(k=1, \ldots, N-1\) &#40;excluindo \(k=0\), pois \(x_{N-0} = x_N\) não está definido&#41;.</p>
</li>
</ul>
<h3 id="comparação_com_a_série_de_fourier"><a href="#comparação_com_a_série_de_fourier" class="header-anchor">Comparação com a série de Fourier</a></h3>
<ul>
<li><p>Aqui, pensando em uma aplicação futura em sinais de áudio, vamos considerar a variável independente como sendo uma variável temporal, denotada por \(t\). E o sinal vamos denotar por \(x=x(t)\).</p>
</li>
<li><p>Vimos que a série de Fourier de uma função \(T\)-periódica \(x=x(t)\) em exponenciais complexas é dada por</p>
</li>
</ul>
\[ x(t) = \sum_{k\in \mathbb{Z}} c_k e^{\frac{i 2k\pi t}{T}}.
\]
<ul>
<li><p>Nesse caso, os coeficientes complexos \(c_k\) podem ser escritos como</p>
</li>
</ul>
\[ c_k = \frac{1}{T}\int_{0}^{T} x(t)e^{-\frac{i 2k\pi t}{T}}\;\mathrm{d}t.
\]
<ul>
<li><p>Se pensarmos em \(x_n \approx x(t_n)\) como uma discretização da função \(x=x(t)\) em uma malha uniforme \((t_n)_n\), com \(\Delta t = t_{n+1}-t_n\) e \(N\Delta t = T\), e aproximarmos a integral por uma soma de Riemann, então</p>
</li>
</ul>
\[ c_k \approx \frac{1}{T} \sum_{n=0}^{N-1} x(t_n) e^{\frac{- 2k\pi i t_n}{T}} \Delta t = \frac{1}{N} \sum_{n=0}^{N-1} x_n e^{\frac{-2k\pi i n}{N}} = \frac{X_k}{N}.
\]
<h3 id="comparação_com_a_transformada_inversa"><a href="#comparação_com_a_transformada_inversa" class="header-anchor">Comparação com a transformada inversa</a></h3>
<ul>
<li><p>Denotando por \([r]\) como o maior inteiro menor do que um dado número real \(r\) positivo, temos</p>
</li>
</ul>
\[ x_n = \frac{1}{N}\sum_{k=0}^{N-1} X_k e^{\frac{2\pi i nk}{N}} = \frac{1}{N}\sum_{k=0}^{[N/2]} X_k e^{\frac{2\pi i nk}{N}} + \frac{1}{N}\sum_{k=[N/2]+1}^{N-1} X_k e^{\frac{2\pi i nk}{N}}.
\]
<ul>
<li><p>Escrevemos \(k = N - j\) no segundo somatório.</p>
</li>
<li><p>Temos, em um extremo, \(k = N - j = N - 1\) em \(j = 1\).</p>
</li>
<li><p>No outro extremo, \(k = N - j = [N/2] + 1\) em \(j = N - [N/2] - 1 = [(N-1)/2]\).</p>
</li>
<li><p>De fato, considerando \(N\) ímpar, temos \(N = 2M+1\) para algum inteiro positivo \(M\), logo </p>
</li>
</ul>
\[ [N/2] = [2M/2 + 1/2] = M = (N-1)/2,
\]
<p>o que nos dá </p>
\[j = N - [N/2] - 1 = 2M+1 - M - 1 =  M = (N-1)/2 = [N-1/2].
\]
<ul>
<li><p>Agora, se \(N=2M\), então </p>
</li>
</ul>
\[ [N/2] = M = N/2, \quad \text{e} \quad  [(N-1)/2] = [ (2M - 1)/2] = [M - 1/2] = M - 1,
\]
<p>o que nos dá </p>
\[j = N - [N/2] - 1  = 2M - M - 1 = M - 1 = [(N-1)/2].\]
<h3 id="continuando"><a href="#continuando" class="header-anchor">Continuando</a></h3>
<ul>
<li><p>Assim,</p>
</li>
</ul>
\[ \begin{align*}
x_n & = \frac{1}{N}\sum_{k=0}^{[N/2]} X_k e^{\frac{2\pi i nk}{N}} + \frac{1}{N}\sum_{j=1}^{[(N-1)/2]} X_{N-j} e^{\frac{2\pi i n(N-j)}{N}} \\
 & = \frac{1}{N}\sum_{k=0}^{[N/2]} X_k e^{\frac{2\pi i nk}{N}} + \frac{1}{N}\sum_{j=1}^{[(N-1)/2]} \overline{X_j}e^{\frac{-2\pi j nk}{N}} \\
 & = \frac{1}{N}\sum_{k=0}^{[N/2]} X_k e^{\frac{2\pi i nk}{N}} + \frac{1}{N}\sum_{k=-1}^{-[(N-1)/2]}\overline{X_{-k}}e^{\frac{2\pi i nk}{N}}
 \end{align*}
\]
<ul>
<li><p>Usando que \(c_k \approx X_k/N\) e que \(c_{-k} = \overline{c_k}\), obtemos</p>
</li>
</ul>
\[ \begin{align*}
  x_n & \approx \sum_{k=0}^{[N/2]} c_k e^{\frac{2\pi i nk}{N}} + \sum_{k=-1}^{-[(N-1)/2]}\overline{c_{-k}}e^{\frac{2\pi i nk}{N}} \\
 & = \sum_{k=0}^{[N/2]} c_k e^{\frac{2\pi i nk}{N}} + \sum_{k=-1}^{-[(N-1)/2]} c_k e^{\frac{2\pi i nk}{N}} = \sum_{k=-[(N-1)/2]}^{[N/2]} c_k e^{\frac{2\pi i nk}{N}}.
 \end{align*}
\]
<ul>
<li><p>No caso em que \(f\) tenha frequências com número de onda no máximo até \([(N-1)/2]\), então \(c_k = 0\), para \(|k|> [(N-1)/2]\), de modo que</p>
</li>
</ul>
\[ x(t_n) =  \sum_{k=-[(N-1)/2]}^{[N/2]} c_k e^{\frac{2\pi i nk}{N}} \approx \sum_{k=-[(N-1)/2]}^{[N/2]} \frac{X_k}{N} e^{\frac{2\pi i nk}{N}} = x_n.
\]
<ul>
<li><p>No caso em que \(N\) é par, temos, mais explicitamente,</p>
</li>
</ul>
\[ x(t_n) = \sum_{k=-N/2+1}^{N/2} c_k e^{\frac{2\pi i nk}{N}} \approx \sum_{k=-N/2+1}^{N/2} \frac{X_k}{N} e^{\frac{2\pi i nk}{N}} = x_n.
\]
<ul>
<li><p>No caso em que \(N\) é impar, temos</p>
</li>
</ul>
\[ x(t_n) = \sum_{k=-(N-1)/2}^{(N-1)/2} c_k e^{\frac{2\pi i nk}{N}} \approx \sum_{k=-(N-1)/2}^{(N-1)/2} \frac{X_k}{N} e^{\frac{2\pi i nk}{N}} = x_n.
\]
<h3 id="indexamento_no_julia"><a href="#indexamento_no_julia" class="header-anchor">Indexamento no Julia</a></h3>
<ul>
<li><p>Observe que indexamento de vetores em Julia começa em 1 <em>&#40;1-based indexing&#41;</em>, como Fortran, MATLAB, Mathematica, Wolfram, Lua, e R. Outras linguagens começam em 0 <em>&#40;0-based indexing&#41;</em>, como Python e C, C&#43;&#43;, Go, PHP e Rust. &#40;veja uma lista mais completa <a href="https://en.wikipedia.org/wiki/Comparison_of_programming_languages_&#40;array&#41;">Comparison of programming languages &#40;array&#41;</a>.</p>
</li>
<li><p>Assim, o vetor \(x=(x_n)_{n=0}^{N-1}\) é representado por um array \(y = (y_i)_{i=1}^N\), assim como a sua transformada discreta de Fourier se torna \(Y_j = (Y_j)_{j=1}^M\).</p>
</li>
<li><p>Uma frequência \(\nu = k/T\), com número de onda \(k\), corresponde ao índice \(j=k+1\).</p>
</li>
<li><p>A relação \(X_{N-k} = \overline{X_k}\), válida para \(k=1, \ldots, N-1\), se torna \(Y_{N-k+1} = \overline{Y_{k+1}}\).</p>
</li>
<li><p>A magnitude da onda senoidal com número de onda \(k\) é \(2|c_k| = 2|X_k|/N = 2|Y_{k+1}|/N\), de \(k>1\) e \(|c_0|=|X_0|/N = |Y_1|/N\), quando \(k=0\).</p>
</li>
<li><p>O vetor abaixo &#40;no caso \(N\) par&#41; forma o espectro de amplitude de \(x(t_n)\), associado às frequências \(\nu = (0, 1/T, \ldots, (N/2 - 1)/T)\):</p>
</li>
</ul>
\[ Z = \left(\frac{|X_0|}{N}, \frac{2|X_1|}{N}, \ldots, \frac{2|X_{N/2-1}|}{N}\right)
\]
<h3 id="transformada_rápida_de_fourier"><a href="#transformada_rápida_de_fourier" class="header-anchor">Transformada rápida de Fourier</a></h3>
<ul>
<li><p>Uma <strong>transformada rápida de Fourier</strong> é um algoritmo eficiente de cálculo da transformada discreta de Fourier. Há vários algoritmos.</p>
</li>
<li><p>O cálculo direto, via cálculo do somatório para cada coeficiente, é um tanto custoso, da ordem de \(\mathcal{O}(N^2).\)</p>
</li>
<li><p>As transformadas rápidas, por sua vez, tem um custo da ordem \(\mathcal{O}(N\log N)\).</p>
</li>
<li><p>Em Julia, a transformada rápida de Fourier é implementado no pacote <a href="https://github.com/JuliaMath/FFTW.jl">JuliaMath/FFTW.jl</a>, que é, na verdade, uma interface para a biblioteca <a href="http://www.fftw.org">FFTW</a>, denotada assim pelo acrônimo de <em>&quot;Fastest Fourier Transform in the West&quot;</em>.</p>
</li>
<li><p>A FFTW contém, na verdade, diversos algoritmos de FFT. A própria biblioteca analisa o tipo de transformada que está sendo feita e escolhe o algoritmo mais rápido para o caso.</p>
</li>
<li><p>Há algoritmos para transformadas discretas reais, complexas, de dados simétricos ou anti-simétricos e de senos ou de cossenos.</p>
</li>
<li><p>Nos exemplos abaixo, vamos nos retringir às funções <code>fft</code>, que calcula a transformada complexa, conforme discutido acima, e <code>rfft</code>, que é a versão real, que pode ser usada no caso em que o seu sinal é real, e retornando apenas os índices de \(0\) a \([N/2]\), considerando-se que os restantes serão complexos conjugados desses.</p>
</li>
</ul>
<h2 id="exemplos"><a href="#exemplos" class="header-anchor">Exemplos</a></h2>
<h3 id="exemplo_de_sinal_constante"><a href="#exemplo_de_sinal_constante" class="header-anchor">Exemplo de sinal constante</a></h3>
<pre><code class="language-julia">fs &#61; 440
Tf &#61; 1.0
tempos &#61; 0.0:inv&#40;fs&#41;:Tf
N &#61; length&#40;tempos&#41; # N &#61; fs &#43; 1 se T &#61;&#61; 1
freqs &#61; 0:div&#40;N,2&#41;/Tf
nothing</code></pre>
<pre><code class="language-julia">k &#61; 0 # número de onda
ν &#61; k/Tf # frequência
A &#61; 0
B &#61; 4
x &#61; A*sin.&#40;2π*ν*tempos&#41; &#43; B*cos.&#40;2π*ν*tempos&#41; # onda senoidal pura, de frequência ν
W &#61; √&#40;A^2 &#43; B^2&#41; # amplitude da onda
nothing</code></pre>
<pre><code class="language-julia">plot&#40;tempos, x, xlabel &#61; &quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing, ylims&#61;&#40;-1.1W,1.1W&#41;,
    title&#61;&quot;Onda senoidal com frequência ν &#61; &#36;ν Hz&quot;, titlefont &#61; 10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_4_1.png" alt="">
<pre><code class="language-julia">X &#61; fft&#40;x&#41;
Xr &#61; rfft&#40;x&#41;
maximum&#40;abs.&#40;X&#91;1:length&#40;Xr&#41;&#93; - Xr&#41;&#41;</code></pre>
<pre><code class="language-julia">5.409610308782961e-14</code></pre>
<pre><code class="language-julia">Z &#61; &#91;abs&#40;Xr&#91;1&#93;&#41;/N; 2abs.&#40;Xr&#91;2:end&#93;&#41;/N&#93;

println&#40;&quot;Amplitude dada diretamente no espaço físico: W &#61; &#36;W&quot;&#41;
println&#40;&quot;Amplitude calculada via FFT: |X_k|/N &#61; &#36;&#40;Z&#91;1&#43;k&#93;&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">Amplitude dada diretamente no espaço físico: W &#61; 4.0
Amplitude calculada via FFT: |X_k|/N &#61; 4.0</code></pre>
<pre><code class="language-julia">scatter&#40;abs.&#40;X&#41;, markersize&#61;2, label&#61;nothing, xlabel&#61;&quot;índice&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Amplitude dos coeficientes da transformada discreta complexa de Fourier&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_7_1.png" alt="">
<pre><code class="language-julia">scatter&#40;freqs, Z, markersize&#61;2, legend&#61;nothing, xlabel&#61;&quot;frequência &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Espectro de amplitude&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_8_1.png" alt="">
<pre><code class="language-julia">scatter&#40;freqs&#91;1:6&#93;, Z&#91;1:6&#93;, markersize&#61;6, legend&#61;nothing, xlabel&#61;&quot;frequência &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Parte inicial do espectro de amplitude&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_9_1.png" alt="">
<h3 id="exemplo_de_onda_senoidal_pura"><a href="#exemplo_de_onda_senoidal_pura" class="header-anchor">Exemplo de onda senoidal pura</a></h3>
<pre><code class="language-julia">k &#61; 3 # número de onda
ν &#61; k/Tf # frequência
A &#61; 3
B &#61; 4
x &#61; A*sin.&#40;2π*ν*tempos&#41; &#43; B*cos.&#40;2π*ν*tempos&#41; # onda senoidal pura, de frequência ν
W &#61; √&#40;A^2 &#43; B^2&#41; # amplitude da onda
plot&#40;tempos, x, xlabel &#61; &quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing, ylims&#61;&#40;-1.1W,1.1W&#41;,
    title&#61;&quot;Onda senoidal com frequência ν &#61; &#36;ν Hz&quot;, titlefont &#61; 10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_10_1.png" alt="">
<pre><code class="language-julia">X &#61; fft&#40;x&#41;
Xr &#61; rfft&#40;x&#41;
maximum&#40;abs.&#40;X&#91;1:length&#40;Xr&#41;&#93; - Xr&#41;&#41;</code></pre>
<pre><code class="language-julia">9.018901711841947e-14</code></pre>
<pre><code class="language-julia">Z &#61; &#91;abs&#40;Xr&#91;1&#93;&#41;/N; 2abs.&#40;Xr&#91;2:end&#93;/N&#41;&#93;

println&#40;&quot;Amplitude dada diretamente no espaço físico: W &#61; &#36;W&quot;&#41;
println&#40;&quot;Amplitude calcula via FFT: |X_k|/N &#61; &#36;&#40;Z&#91;1&#43;k&#93;&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">Amplitude dada diretamente no espaço físico: W &#61; 5.0
Amplitude calcula via FFT: |X_k|/N &#61; 5.001210101433121</code></pre>
<pre><code class="language-julia">scatter&#40;abs.&#40;X&#41;, markersize&#61;2, label&#61;nothing, xlabel&#61;&quot;índice&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Amplitude dos coeficientes da transformada discreta complexa de Fourier&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_13_1.png" alt="">
<pre><code class="language-julia">scatter&#40;freqs&#91;1:6&#93;, Z&#91;1:6&#93;, markersize&#61;6, legend&#61;nothing, xlabel&#61;&quot;frequência &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Parte inicial do espectro de amplitude&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_14_1.png" alt="">
<h3 id="exemplo_de_combinação_de_frequências"><a href="#exemplo_de_combinação_de_frequências" class="header-anchor">Exemplo de combinação de frequências</a></h3>
<pre><code class="language-julia">ks &#61; &#40;3, 5, 8, 16, 17&#41; # número de onda
νs &#61; ks./Tf # frequências
As &#61; rand&#40;MersenneTwister&#40;358&#41;,length&#40;ks&#41;&#41;
Bs &#61; rand&#40;length&#40;ks&#41;&#41;
x &#61; sum&#40;&#91;A * sin.&#40;2π*ν*tempos&#41; &#43; B*cos.&#40;2π*ν*tempos&#41; for &#40;A,B,ν&#41; in zip&#40;As, Bs, νs&#41;&#93;&#41; 
Ws &#61; sqrt.&#40;As.^2 .&#43; Bs.^2&#41;
plot&#40;tempos, x, xlabel &#61; &quot;tempo &#40;s&#41;&quot;, ylabel&#61;&quot;amplitude&quot;, label&#61;nothing, ylims&#61;&#40;-1.1W,1.1W&#41;,
    title&#61;&quot;Onda senoidal com frequência ν &#61; &#36;ν Hz&quot;, titlefont &#61; 10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_15_1.png" alt="">
<pre><code class="language-julia">X &#61; fft&#40;x&#41;
Xr &#61; rfft&#40;x&#41;
maximum&#40;abs.&#40;X&#91;1:length&#40;Xr&#41;&#93; - Xr&#41;&#41;</code></pre>
<pre><code class="language-julia">2.4615772823458266e-14</code></pre>
<pre><code class="language-julia">Z &#61; &#91;abs&#40;Xr&#91;1&#93;&#41;/N; 2abs.&#40;Xr&#91;2:end&#93;/N&#41;&#93;

println&#40;&quot;Amplitudes dadas diretamente no espaço físico: W &#61; &#36;Ws&quot;&#41;
println&#40;&quot;Amplitudes calculadas via FFT: |X_k|/N &#61; &#36;&#40;&#91;Z&#91;i&#43;1&#93; for i in ks&#93;&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">Amplitudes dadas diretamente no espaço físico: W &#61; &#91;0.45969154387011624, 1.
0120174580549002, 1.056402316556411, 0.9164337999078864, 0.2275601352669085
2&#93;
Amplitudes calculadas via FFT: |X_k|/N &#61; &#91;0.46655486884496034, 1.0198700385
298516, 1.0552431856407234, 0.917420982036402, 0.19217913880135268&#93;</code></pre>
<pre><code class="language-julia">scatter&#40;abs.&#40;X&#41;, markersize&#61;2, label&#61;nothing, xlabel&#61;&quot;índice&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Amplitude dos coeficientes da transformada discreta complexa de Fourier&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_18_1.png" alt="">
<pre><code class="language-julia">scatter&#40;freqs&#91;1:20&#93;, Z&#91;1:20&#93;, xticks&#61;freqs&#91;1:20&#93;, markersize&#61;6, legend&#61;nothing, xlabel&#61;&quot;frequência &#40;Hz&#41;&quot;, ylabel&#61;&quot;amplitude&quot;,
    title&#61;&quot;Parte inicial do espectro de amplitude&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c11/1102-Transformada_discreta_Fourier/code/images/1102-Transformada_discreta_Fourier_19_1.png" alt="">
<pre><code class="language-julia">@show length&#40;freqs&#41;
@show length&#40;Xr&#41;
@show length&#40;Z&#41;</code></pre>
<pre><code class="language-julia">length&#40;freqs&#41; &#61; 221
length&#40;Xr&#41; &#61; 221
length&#40;Z&#41; &#61; 221
221</code></pre>
<pre><code class="language-julia">div&#40;N,2&#41;&#43;1</code></pre>
<pre><code class="language-julia">221</code></pre>
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Verifique a afirmação de que \(x_n \approx f(t_n)\) no caso em que \(N\) é par, indicado acima.</p>
</li>
<li><p>Mostre que a transformada inversa é, de fato, a inversa da transformada discreta de Fourier, i.e.</p>
</li>
</ol>
\[ \frac{1}{N}\sum_{k=0}^{N-1} \sum_{j=0}^{N-1} x_j e^{\frac{-2\pi i kj}{N}} e^{\frac{2\pi i nk}{N}} = x_n, \qquad n=0, \ldots, N-1.
\]

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais"><kbd>→</kbd> 11.3. Ondas sonoras e elementos musicais</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: July 05, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/modelagem_matematica/libs/katex/katex.min.js"></script>
        <script src="/modelagem_matematica/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
