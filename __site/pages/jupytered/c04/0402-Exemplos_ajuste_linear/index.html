<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Exemplos de ajuste linear</title>  
  <link rel="shortcut icon" type="image/png" href="/modelagem_matematica/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/modelagem_matematica/css/base.css"/>
  
  <script src="/modelagem_matematica/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/highlight/github.min.css">
    <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
    <script src="/modelagem_matematica/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/modelagem_matematica/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/modelagem_matematica/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes"><kbd>→</kbd> 4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c04/0402-Exemplos_ajuste_linear.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c04/0402-Exemplos_ajuste_linear.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/modelagem_matematica/generated/jupytered/c04/0402-Exemplos_ajuste_linear.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/modelagem_matematica/src/jupyter/c04/0402-Exemplos_ajuste_linear.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1 id="get_title"><a href="#get_title" class="header-anchor">4.2. Exemplos de ajuste linear</a></h1>
<pre><code class="language-julia">using Plots</code></pre>
<h2 id="salário_e_grau_de_instrução"><a href="#salário_e_grau_de_instrução" class="header-anchor">Salário e grau de instrução</a></h2>
<ul>
<li><p>Como nosso primeiro exemplo, vamos comparar o salário anual médio com o grau de instrução.</p>
</li>
<li><p>Dados dos EUA, obtidos de <a href="https://www.bls.gov/careeroutlook/2020/data-on-display/education-pays.htm">US Bureau of Labor Statistics: Learn more, earn more: Education leads to higher wages, lower unemployment</a>.</p>
</li>
</ul>
<table><tr><th align="right">Nível de instrução</th><th align="right">Média de salário semanal &#40;USD&#36;&#41;</th><th align="right">Taxa de desemprego &#40;&#37;&#41;</th></tr><tr><td align="right">Doutorado</td><td align="right">1883</td><td align="right">1,1</td></tr><tr><td align="right">Profissional</td><td align="right">1861</td><td align="right">1,6</td></tr><tr><td align="right">Mestrado</td><td align="right">1497</td><td align="right">2,0</td></tr><tr><td align="right">Graduação</td><td align="right">1248</td><td align="right">2,2</td></tr><tr><td align="right">Associado*</td><td align="right">887</td><td align="right">2,7</td></tr><tr><td align="right">Graduação incompleta</td><td align="right">833</td><td align="right">3.3</td></tr><tr><td align="right">Ensino Médio</td><td align="right">746</td><td align="right">3,7</td></tr><tr><td align="right">Ensino Fundamental</td><td align="right">592</td><td align="right">5,4</td></tr></table>
<ul>
<li><p><em>Associado</em> é um grau conferido em algumas instituições de nível superior, em cursos de dois a três anos.</p>
</li>
</ul>
<pre><code class="language-julia">y &#61; &#91;592, 746, 833, 887, 1248, 1497, 1861, 1883&#93;
plot&#40;y, seriestype &#61; :scatter, xlims&#61;&#40;0,9&#41;, ylims&#61;&#40;0,2000&#41;,
    xticks&#61;0:9, xaxis &#61; &quot;nível de instrução&quot;, yaxis&#61;&quot;salário &#40;USD\&#36;&#41;&quot;, 
    title&#61;&quot;Média salarial semanal em função do grau de instrução&quot;, 
    titlefont&#61;12, legend&#61;false&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c04/0402-Exemplos_ajuste_linear/code/images/0402-Exemplos_ajuste_linear_2_1.png" alt="">
<ul>
<li><p>Queremos ajustar um modelo simples linear \(y=\beta_0 + \beta_1 x\), onde \(x\) representa o grau de instrução e \(y\), o salário.</p>
</li>
<li><p>O grau de instrução não tem uma escala muito bem definida como exibido acima, mas seguimos assim para efeitos ilustrativos, do método de mínimos quadrados.</p>
</li>
<li><p>De qualquer forma, é nítida a relação entre as duas variáveis.</p>
</li>
<li><p>Queremos, então, minimizar o erro quadrático \(E=\sum_i |y_j - \beta_0 + \beta_1 x_j|^2\).</p>
</li>
<li><p>Para isso, montamos a matrix de Vandermonde</p>
</li>
</ul>
\[ A = \left[ \begin{matrix} 1 & x_1 \\ 1 & x_2 \\ \ldots & \ldots \\ 1 & x_8 \end{matrix} \right] = \left[ \begin{matrix} 1 & 1 \\ 1 & 2 \\\ldots & \ldots \\ 1 & 8 \end{matrix} \right]
\]
<ul>
<li><p>E minimizamos \(E = \|\mathbf{y} - A\mathbf{x}\|^2\), onde</p>
</li>
</ul>
\[ \mathbf{x} = (x_i)_{i=1}^8 = (1,\ldots, 8) \quad \mathbf{y} = (y_i)_i = (592, 746, 833, 887, 1248, 1497, 1861, 1883).
\]
<ul>
<li><p>Solucionamos isso em julia com o operador <a href="https://github.com/JuliaLang/julia/blob/master/stdlib/LinearAlgebra/src/generic.jl#L1144"><br/></a>.</p>
</li>
<li><p>Antes, definimos a matrix \(A\).</p>
</li>
</ul>
<pre><code class="language-julia">A &#61; &#91;1 1; 1 2; 1 3; 1 4; 1 5; 1 6; 1 7; 1 8&#93;</code></pre>
<pre><code class="language-julia">8×2 Matrix&#123;Int64&#125;:
 1  1
 1  2
 1  3
 1  4
 1  5
 1  6
 1  7
 1  8</code></pre>
<ul>
<li><p>Também podemos fazer isso de forma mais programática:</p>
</li>
</ul>
<pre><code class="language-julia">A &#61; &#91;ones&#40;8&#41; collect&#40;1:8&#41;&#93;</code></pre>
<pre><code class="language-julia">8×2 Matrix&#123;Float64&#125;:
 1.0  1.0
 1.0  2.0
 1.0  3.0
 1.0  4.0
 1.0  5.0
 1.0  6.0
 1.0  7.0
 1.0  8.0</code></pre>
<ul>
<li><p>O vetor \(\mathbf{y}\) já foi definido acima, quando da exibição do gráfico.</p>
</li>
<li><p>A solução do problema de mínimos quadrados é dada por <code>A\y</code>.</p>
</li>
</ul>
<pre><code class="language-julia">x &#61; A\y</code></pre>
<pre><code class="language-julia">2-element Vector&#123;Float64&#125;:
 284.53571428571445
 201.9642857142857</code></pre>
<ul>
<li><p>Isso nos dá \(\beta_0=284.54\) e \(\beta_1=201.96\).</p>
</li>
<li><p>E a visualização do modelo ajustado.</p>
</li>
</ul>
<pre><code class="language-julia">y &#61; &#91;592, 746, 833, 887, 1248, 1497, 1861, 1883&#93;
plot&#40;y, seriestype &#61; :scatter, xlims&#61;&#40;0,9&#41;, ylims&#61;&#40;0,2000&#41;,
    xticks&#61;0:9, xaxis &#61; &quot;nível de instrução&quot;, yaxis&#61;&quot;salário &#40;USD\&#36;&#41;&quot;, 
    label&#61;&quot;salário&quot;, title&#61;&quot;Média salarial semanal em função do grau de instrução&quot;, 
    titlefont&#61;12, legend&#61;:topleft&#41;
plot&#33;&#40;&#91;&#40;0,x&#91;1&#93;&#41;, &#40;9,x&#91;1&#93; &#43; x&#91;2&#93;*9&#41;&#93;, label&#61;&quot;modelo ajustado&quot;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c04/0402-Exemplos_ajuste_linear/code/images/0402-Exemplos_ajuste_linear_6_1.png" alt="">
<h2 id="o_operador"><a href="#o_operador" class="header-anchor">O operador \</a></h2>
<ul>
<li><p>Em Julia, o operador &#92; funciona de maneira diferente de acordo com o tipo de matriz &#40;um polialgoritmo&#41;.</p>
</li>
<li><p>Se \(A\) for uma matriz quadrada, é feita uma decomposição \(LU\) &#40;como um produto de uma matriz triangular inferior e uma superior&#41;.</p>
</li>
<li><p>Se \(A\) for retangular, é feita uma decomposição \(QR\).</p>
</li>
<li><p>Este não é um curso de computação científica, mas, para os interessados, é possível, no Julia, ver facilmente a implementação de uma operador.</p>
</li>
<li><p>Podemos ver onde fica o código fonte para uma expressão <code>expr</code> com o comando <code>@which expr</code>.</p>
</li>
<li><p><code>@which</code> pertence ao pacote padrão <a href="https://docs.julialang.org/en/v1/stdlib/InteractiveUtils/">InteractiveUtils</a>, que é carregado automaticamente em modo iterativo &#40;e.g. REPL, Jupyter, Pluto&#41;, mas aqui carregamos explicitamente.</p>
</li>
</ul>
<pre><code class="language-julia">using InteractiveUtils
@which A\y</code></pre>
<pre><code class="language-julia">\&#40;A::AbstractMatrix, B::AbstractVecOrMat&#41; in LinearAlgebra at /Applications
/Julia-1.7.app/Contents/Resources/julia/share/julia/stdlib/v1.7/LinearAlgeb
ra/src/generic.jl:1128</code></pre>
<ul>
<li><p>A localização é em relação à instalação local do Julia.</p>
</li>
<li><p>Os códigos de todos os pacotes do Julia, no entanto, estão todos disponíveis no github e são praticamente todos escritos na própria linguagem julia.</p>
</li>
<li><p>No caso acima, a expressão <code>A\b</code> está no pacote padrão <code>LinearAlgebra</code>, no aquivo <code>generic.jl</code>, na linha 1122.</p>
</li>
<li><p>Esse pacote está disponível em <a href="https://github.com/JuliaLang/julia/tree/master/stdlib/LinearAlgebra">github.com/JuliaLang/julia/stdlib/LinearAlgebra</a>, e o arquivo, em <a href="https://github.com/JuliaLang/julia/blob/master/stdlib/LinearAlgebra/src/generic.jl">generic.jl</a>.</p>
</li>
<li><p>A linha exata pode variar um pouco do listado pelo comando <code>@which</code>, pois o código já pode ter tido modificações depois da instalação local &#40;que por sua vez também pode ser atualizada&#41;.</p>
</li>
<li><p>No caso acima, o link exato é <a href="https://github.com/JuliaLang/julia/blob/master/stdlib/LinearAlgebra/src/generic.jl#L1125">generic.jl#L1125</a></p>
</li>
</ul>
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Faço o ajuste de um modelo linear aos dados de <em>taxa de desemprego</em> em relação ao <em>grau de instrução</em>, exibidos no texto, obtidos da fonte <a href="https://www.bls.gov/careeroutlook/2020/data-on-display/education-pays.htm">US Bureau of Labor Statistics: Learn more, earn more: Education leads to higher wages, lower unemployment</a>.</p>
</li>
<li><p>Buscar os dados de salário e nível de instrução no Brasil e fazer o ajuste de um modelo linear representando a relação entre os dois.</p>
</li>
</ol>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes"><kbd>→</kbd> 4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: June 05, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/modelagem_matematica/libs/katex/katex.min.js"></script>
        <script src="/modelagem_matematica/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
