<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Equações a derivadas parciais e diferenças finitas</title>  
  <link rel="shortcut icon" type="image/png" href="/modelagem_matematica/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/modelagem_matematica/css/base.css"/>
  
  <script src="/modelagem_matematica/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/highlight/github.min.css">
    <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
    <script src="/modelagem_matematica/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/modelagem_matematica/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Modelos em Eletrônica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c08/0801-Modelo_diodo">8.1. Modelagem da relação voltagem-corrente de um diodo</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Reações Químicas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0901-Lei_acao_de_massas">9.1. Lei de ação de massas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0902-Reacoes_enzimaticas">9.2. Modelagem de reações enzimática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0903-Isomerizacao">9.3. Lupulagem e a conversão de humulone em iso-humulone considerando saturação</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Modelos Epidemiológicos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1001-Modelos_epidemiologicos_compartimentais">10.1. Modelos epidemiológicos compartimentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1002-Ajuste_SIR">10.2. Ajustando um modelo SIR a uma epidemia de Influenza</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1004-Individual_estocastico">10.4. Modelos individuais</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Séries de Fourier e Aplicações</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1102-Transformada_discreta_Fourier">11.2. Transformada discreta de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio</a></li>
    </div>
    <div class="menu-level-1">
    <li>12. Equações a Derivadas Parciais</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1201-EDP_e_diferencas_finitas">12.1. Equações a derivadas parciais e diferenças finitas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1202-EDP_advecao">12.2. Equação de adveçcão</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1203-EDP_calor">12.3. Equação do calor unidimensional</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1204-EDP_onda">12.4. Equação da onda unidimensional</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1205-EDP_calor_bidimensional">12.5. Equação do calor em duas dimensões espaciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1206-EDP_onda_bidimensional">12.6. Equação da onda em duas dimensões espaciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1207-Ondas_sismicas">12.7. Ondas sísmicas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c12/1208-Resfriamento_rapido_morangos">12.8. Modelagem matemática e simulação numérica do resfriamento rápido de morangos com o ar forçado</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/appendix">Appendix</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/modelagem_matematica/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c12/1202-EDP_advecao"><kbd>→</kbd> 12.2. Equação de adveçcão</a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c12/1201-EDP_e_diferencas_finitas.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c12/1201-EDP_e_diferencas_finitas.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/modelagem_matematica/generated/jupytered/c12/1201-EDP_e_diferencas_finitas.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/modelagem_matematica/src/jupyter/c12/1201-EDP_e_diferencas_finitas.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1 id="get_title"><a href="#get_title" class="header-anchor">12.1. Equações a derivadas parciais e diferenças finitas</a></h1>
<h2 id="objetivos"><a href="#objetivos" class="header-anchor">Objetivos:</a></h2>
<ul>
<li><p>Noções básicas de EDPs </p>
</li>
<li><p>Modelos clássicos de EDPs</p>
</li>
<li><p>Aproximações numéricas via diferenças finitas</p>
</li>
</ul>
<pre><code class="language-julia">using Plots</code></pre>
<h2 id="equações_a_derivadas_parciais"><a href="#equações_a_derivadas_parciais" class="header-anchor">Equações a derivadas parciais</a></h2>
<ul>
<li><p>Uma <strong>equação a derivada parciais</strong> é uma equação cuja incógnita &#40;ou variável dependente&#41; depende de mais de uma variável independente e que envolve derivadas parciais da incógnita.</p>
</li>
<li><p>Em vários exemplos, uma das variáveis independentes é uma variável temporal, denotada por \(t\).</p>
</li>
<li><p>Outras váriáveis podem indicar coordenadas espaciais, como \(x\), \(y\), \(z\).</p>
</li>
<li><p>Em outros casos, podemos ter variáveis indicando comprimento de arco \(s\), distância \(r\) até um ponto ou um eixo, ângulo \(\theta\), temperatura, umidade, salinidade, concentração de uma substância, etc.</p>
</li>
</ul>
<h2 id="notacão"><a href="#notacão" class="header-anchor">Notacão</a></h2>
<ul>
<li><p>Se \(u\) é a variável dependente, podemos denotar as suas derivadas parciais de primeira ordem de várias maneiras, por exemplo,</p>
</li>
</ul>
\[ \frac{\partial u}{\partial x}, \quad \partial_x u, \quad D_x u, \quad u_x.
\]
<ul>
<li><p>As de segunda ordem e, mais geralmente, ordem \(n\in \mathbb{N}\),</p>
</li>
</ul>
\[ \frac{\partial^2 u}{\partial x^2}, \quad \partial_x^2 u, \quad D_x^2 u, \quad u_{xx}, \quad \frac{\partial^n u}{\partial x^n}, \quad \partial_x^n u, \quad D_x^n u, \quad u_{x\cdots x}.
\]
<ul>
<li><p>A <strong>ordem</strong> de uma equação diferencial é dada pela ordem da derivada parcial de maior ordem.</p>
</li>
<li><p>Certas combinações ou vetores de deriadas parciais recebem notações e denominações especiais, como o <em>gradiente</em> \(\nabla u\), o <em>divergente</em> \(\nabla \cdot u\) e o <em>laplaciano</em> \(\Delta u\), como vistos no curso de Cálculo de várias variáveis.</p>
</li>
</ul>
<h2 id="exemplos_lineares_clássicos"><a href="#exemplos_lineares_clássicos" class="header-anchor">Exemplos lineares clássicos</a></h2>
<ul>
<li><p>Equação de advecção em uma dimensão espacial:</p>
</li>
</ul>
\[u_t + c u_x = 0;\]
<ul>
<li><p>Equaçao de advecção em várias dimensões:</p>
</li>
</ul>
\[u_t + \vec{c} \cdot \nabla u;\]
<ul>
<li><p>Equação do calor em uma dimensão:</p>
</li>
</ul>
\[u_t = \nu u_{xx};\]
<ul>
<li><p>Equação do calor em várias dimensões:</p>
</li>
</ul>
\[u_t = \nu \Delta u;\]
<ul>
<li><p>Equação da onda em uma dimensão:</p>
</li>
</ul>
\[u_{tt} = c^2 u_{xx};\]
<ul>
<li><p>Equação da onda em várias dimensões: </p>
</li>
</ul>
\[u_{tt} = c^2 \Delta u;\]
<ul>
<li><p>Equação de deformação de uma placa isotrópica homogênea:</p>
</li>
</ul>
\[ u_{tt} = - \lambda \Delta^2 u.
\]
<h2 id="exemplos_não-lineares_clássicos"><a href="#exemplos_não-lineares_clássicos" class="header-anchor">Exemplos não-lineares clássicos</a></h2>
<ul>
<li><p>Equação de Burgers &#40;ondas de choque&#41;:</p>
</li>
</ul>
\[u_t + uu_x = 0;\]
<ul>
<li><p>Equação de Korteweg-de Vries &#40;ondas viajantes&#41;:</p>
</li>
</ul>
\[u_t + uu_x + u_{xxx} = 0;\]
<ul>
<li><p>Equação de reação e difusão &#40;calor, reações químicas, etc.&#41;:</p>
</li>
</ul>
\[u_t = \nu u_{xx} + f(u);\]
<ul>
<li><p>Equação de Navier-Stokes &#40;movimento de fluidos viscosos Newtonianos incompressíveis&#41;:</p>
</li>
</ul>
\[ u_t + (u\cdot \nabla)u + \nabla p = \nu\Delta u + f, \quad \nabla \cdot u = 0.
\]
<ul>
<li><p>Superfícies mínimas &#40;e.g. formato bolha de sabão&#41;</p>
</li>
</ul>
\[ \nabla \cdot \left( \frac{\nabla u}{\sqrt{1+\|\nabla u \|^2}} \right) = 0.
\]
<h2 id="problema_de_valor_inicial"><a href="#problema_de_valor_inicial" class="header-anchor">Problema de valor inicial</a></h2>
<ul>
<li><p>É comum que uma das variáveis seja a variável temporal e que estejamos interessados em descobrir \(u(t,x)\) para \(t\geq t_0\), a partir do conhecimento do estado <strong>inicial</strong> \(u(t_0,x) = u_0(x)\), em um <strong>instante inicial</strong> \(t_0\).</p>
</li>
<li><p>Nesse caso, temos um <strong>problema de valor inicial</strong>.</p>
</li>
</ul>
<h2 id="condições_de_contorno"><a href="#condições_de_contorno" class="header-anchor">Condições de contorno</a></h2>
<ul>
<li><p>Na maioria dos casos, a região de interesse não é o espaço todo, nem mesmo um semi-espaço \(t\geq t_0\).</p>
</li>
<li><p>É comum termos um domínio espacial limitado \(\Omega\subset \mathbb{R}^d\), em algum espaço Euclidiano \(\mathbb{R}^d\) &#40;ou mesmo em uma variedade&#41;.</p>
</li>
<li><p>Nesse caso, esperamos que a equação a derivadas parciais seja satisfeita no domínio \(\Omega\), mas sendo necessário determinar o que acontece no bordo \(\partial\Omega\) do domínio.</p>
</li>
<li><p>Nesse caso, temos um <strong>problema de valores de contorno</strong>.</p>
</li>
<li><p>Veremos exemplos de problemas de valores de contorno as aplicações.</p>
</li>
</ul>
<h2 id="aproximando_derivadas_via_diferenças_finitas"><a href="#aproximando_derivadas_via_diferenças_finitas" class="header-anchor">Aproximando derivadas via diferenças finitas</a></h2>
<ul>
<li><p>Há vários métodos numéricos para a resolução de equações a derivadas parciais, como <em>diferenças finitas</em>, <em>elementos finitos</em>, <em>volumes finitos</em>, etc.</p>
</li>
<li><p>E cada método possui diversas variações.</p>
</li>
<li><p>Aqui, vamos considerar apenas diferenças finitas.</p>
</li>
<li><p>Diferenças finitas podem ser justificadas a partir de expansões de Taylor.</p>
</li>
</ul>
<h3 id="diferença_finita_de_primeira_ordem_para_a_frente"><a href="#diferença_finita_de_primeira_ordem_para_a_frente" class="header-anchor">Diferença finita de primeira ordem para a frente</a></h3>
<ul>
<li><p>Esta é como um método de Euler para a resolução de EDOs.</p>
</li>
<li><p>Dada uma função diferenciável \(u=u(x)\) em um ponto \(x\in\mathbb{R}\), temos que</p>
</li>
</ul>
\[ (Du)(x) = \lim_{h\rightarrow 0} \frac{u(x+h)-u(x)}{h}.
\]
<ul>
<li><p>Assim, uma primeira aproximação pode ser obtida tomando-se um \(h>0\) relativamente pequeno e considerando-se</p>
</li>
</ul>
\[ (\delta_h^+ u)(x) = \frac{u(x+h)-u(x)}{h}.
\]
<ul>
<li><p>Mas quão boa é essa aproximação?</p>
</li>
<li><p>Isso depende da regularidade de \(u\).</p>
</li>
</ul>
<h3 id="taxa_de_convergência"><a href="#taxa_de_convergência" class="header-anchor">Taxa de convergência</a></h3>
<ul>
<li><p>Se a função for contínua e diferenciável em todos os pontos mas a sua derivada não for contínua no ponto, então essa aproximação pode nao ser muito boa. </p>
</li>
<li><p>Por exemplo, considere, para \(0<\theta<1\), a função</p>
</li>
</ul>
\[ u(x) = x^{1+\theta}, \qquad x\geq 0.
\]
<ul>
<li><p>A sua derivada é contínua e é dada por</p>
</li>
</ul>
\[ u'(x) = (1+\theta)x^\theta, \qquad x\geq 0.
\]
<ul>
<li><p>Mas \(u(\cdot)\) não é duas vezes diferenciável na origem e \(u'(\cdot)\) é apenas Hölder contínua na origem.</p>
</li>
<li><p>A diferença finita de \(u\) na origem é</p>
</li>
</ul>
\[ (\delta_h^+u)(0) = \frac{h^{1+\theta} - 0}{h} = h^\theta.
\]
<ul>
<li><p>A convergência \((\delta_h^+u)(0) \rightarrow u'(0)\) pode ser cada vez mais lenta, quanto menor for \(\theta\):</p>
</li>
</ul>
\[ |(\delta_h^+u)(0) - u'(0)| \lesssim h^\theta,
\]
<h3 id="ordem_da_aproximação"><a href="#ordem_da_aproximação" class="header-anchor">Ordem da aproximação</a></h3>
<ul>
<li><p>Já se a função for continuamente diferenciável, com derivada Lipschitz contínua no origem, então, usando o Teorema Fundamental do Cálculo,</p>
</li>
</ul>
\[
\begin{align*}
  (\delta_h^+ u)(x) - (Du)(x) & = \frac{u(x+h)-u(x)}{h} - (Du)(x) \\
  & = \frac{1}{h} \int_x^{x+h} (Du)(\xi)\;d\xi - (Du)(x) \\
  & = \frac{1}{h} \int_x^{x+h} \left((Du)(\xi) - (Du)(x)\right)\;d\xi.
\end{align*}
\]
<ul>
<li><p>Usando a continuidade Lipschitz de \(Du\), com constante de Lipchitz \(L\), obtemos a <em>aproximação linear</em></p>
</li>
</ul>
\[ |(\delta_h^+ u)(x) - (Du)(x)| \leq \max_{x\leq \xi \leq x+h} |(Du)(\xi) - (Du)(x)| \leq \max_{x\leq \xi \leq x+h} \frac{1}{h}\int_0^h L\xi \;d\xi \leq \frac{Lh}{2}.
\]
<ul>
<li><p>Usando a notação de &quot;\(\mathcal{O}\) grande&quot;, escrevemos</p>
</li>
</ul>
\[ (\delta_h^+ u)(x) = (Du)(x) + \mathcal{O}(h), \qquad h\rightarrow 0.
\]
<ul>
<li><p>Lembrando que &quot;\(\mathcal{O}\) grande&quot; significa</p>
</li>
</ul>
\[ f(h) = \mathcal{O}(|h|^\alpha), \;h\rightarrow h_0 \Leftrightarrow \exists C>0, \exists \delta > 0, \; |f(h)-f(h_0)| \leq C |h|^\alpha, \;\forall 0<|h|<\delta,
\]
<ul>
<li><p>E &quot;\(\mathcal{o}\) pequeno&quot; significa</p>
</li>
</ul>
\[ f(h) = \mathcal{o}(|h|^\alpha), \;h\rightarrow h_0 \Leftrightarrow  \frac{|f(h)-f(h_0)|}{|h|^\alpha} \rightarrow 0, \; h\rightarrow h_0.
\]
<ul>
<li><p>Essas noções de comportamento assintótico podem ser generalizadas para \(h_0=\pm\infty\) e em relação a funções \(g=g(h)\) mais gerais que \(|h|^\alpha\).</p>
</li>
</ul>
<h3 id="expansão_de_taylor"><a href="#expansão_de_taylor" class="header-anchor">Expansão de Taylor</a></h3>
<ul>
<li><p>Assumindo a função suave, podemos escrever, mais diretamente,</p>
</li>
</ul>
\[ u(x+h) = u(x) + u'(x)h + u''(x)\frac{h^2}{2} + \cdots.
\]
<ul>
<li><p>Lembre-se que a parte \(\cdots\) contém termos de ordem \(h^n\), com \(n=3,4, \cdots\).</p>
</li>
<li><p>Assim, podemos escrever</p>
</li>
</ul>
\[ (\delta_h^+ u)(x) = \frac{u(x+h)-u(x)}{h} = u'(x) + u''(x)\frac{h^2}{2} + \cdots.
\]
<ul>
<li><p>Portanto,</p>
</li>
</ul>
\[ \left|(\delta_h^+ u)(x) - u'(x)\right| = Ch + \cdots = \mathcal{O}(h).
\]
<ul>
<li><p>Da mesma forma, a diferença de primeira ordem para trás, \((\delta_h^- u)(x) = (u(x-h) - u(x))/(-h) = (u(x)-u(x-h))/h\) também é de primeira ordem.</p>
</li>
</ul>
<h3 id="diferença_centrada"><a href="#diferença_centrada" class="header-anchor">Diferença centrada</a></h3>
<ul>
<li><p>Uma aproxição melhor, de segunda ordem, para a primeira derivada, pode ser obtida através de uma diferença centrada:</p>
</li>
</ul>
\[ (\delta_h^0u)(x) = \frac{u(x+h) - u(x-h)}{2h} = \frac{1}{2h}\left( u(x+h) - u(x) + u(x) - u(x-h) \right) = \frac{1}{2h}\left(u'(x)h + u''(x)\frac{h^2}{2} - u'(x)(-h) - u''(x)(-h)^2 + \mathcal{O}(h^3) \right) = u'(x) + \mathcal{O}(h^2).
\]
<ul>
<li><p>Observe que </p>
</li>
</ul>
\[ \delta_h^0 = \frac{\delta_h^+ + \delta_h^-}{2}.
\]
<ul>
<li><p>Aproximações de ordem ainda maior podem ser obtidas com outras combinações, em particular incluindo outros pontos \(u(x+2h)\), \(u(x-2h)\), etc.</p>
</li>
</ul>
<h3 id="aproximação_da_segunda_derivada"><a href="#aproximação_da_segunda_derivada" class="header-anchor">Aproximação da segunda derivada</a></h3>
<ul>
<li><p>Aproximações para a segunda derivada também podem ser obtida com combinações apropriadas.</p>
</li>
<li><p>Por exemplo, uma aproximação de segunda ordem clássica é</p>
</li>
</ul>
\[ (\delta_h^2u)(x) = \frac{u(x+h) - 2u(x) + u(x-h)}{h^2} = u''(x) + \mathcal{O}(h^2).
\]
<ul>
<li><p>Verifique&#33;</p>
</li>
<li><p>Observe que</p>
</li>
</ul>
\[ \delta_h^2u = \frac{\delta_h^+ - \delta_h^-}{h}.
\]
<h2 id="discretização_espacial"><a href="#discretização_espacial" class="header-anchor">Discretização espacial</a></h2>
<ul>
<li><p>A última peça do método de diferenças finitas é a aproximação da função em uma malha discreta, com um número finito de pontos.</p>
</li>
</ul>
<h3 id="discretização_unidimensional_uniforme"><a href="#discretização_unidimensional_uniforme" class="header-anchor">Discretização unidimensional uniforme</a></h3>
<ul>
<li><p>No caso de uma dimensão espacial, em um intervalo \(I=[0,L]\), podemos considerar uma <strong>malha uniforme</strong> composta por \(N\) pontos \(0=x_1<x_2<\ldots<x_N=L\), com um espaçamento igual \(x_{i+1}-x_i =h\), \(i=1, \ldots, n\), onde \(h>0\) é constante.</p>
</li>
<li><p>Nesse caso, temos \(N\) pontos e \(N-1\) intervalos, com \((N-1)h=L\) e \(x_i = (i-1)h\).</p>
</li>
</ul>
<pre><code class="language-julia">N &#61; 20
L &#61; 4
x &#61; range&#40;0.0, L, length&#61;N&#41;
scatter&#40;x, zero&#40;x&#41;, markersize&#61;4, legend&#61;false&#41;
plot&#33;&#40;title&#61;&quot;Malha uniforme&quot;, titlefont&#61;10, size&#61;&#40;600,100&#41;, ylims&#61;&#40;-0.1, 0.2&#41;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c12/1201-EDP_e_diferencas_finitas/code/images/1201-EDP_e_diferencas_finitas_2_1.png" alt="">
<h3 id="discretização_unidimensional_não-uniforme"><a href="#discretização_unidimensional_não-uniforme" class="header-anchor">Discretização unidimensional não-uniforme</a></h3>
<ul>
<li><p>A discretização não precisa ser uniforme.</p>
</li>
<li><p>Podemos considerar qualquer malha satisfazendo \(0=x_1<x_2<\ldots<x_N=L\).</p>
</li>
<li><p>Pode ser útil, por exemplo, ter um espaçamento menor em regiões onde a derivada tem uma variação maior.</p>
</li>
<li><p>Podemos construir malhas não-uniformes com simples transformações.</p>
</li>
<li><p>Por exemplo, considerando \(s_i = (i-1)h\), \(i=1, \ldots, N\), com \(h>0\) constante e \((N-1)h=1\), que é uma malha uniforme no intervalo unitário \([0,1]\), podemos definir</p>
</li>
</ul>
\[ x_i = \frac{L}{2}\left( 1 + \cos(\pi s_i)\right), \qquad i=1,\ldots, N.
\]
<ul>
<li><p>Mais explicitamente,</p>
</li>
</ul>
\[ x_i = \frac{L}{2}\left( 1 + \cos\left({\frac {2i-1}{2N}}\pi \right)\right), \qquad i=1,\ldots, N.
\]
<ul>
<li><p>Esses pontos são conhecidos como pontos de Chebyshev e podem ser interpretados como as coordenadas, no eixo \(x\), de pontos uniformemente espaçados no semicírculo superior de um círculo de diâmetro \(L\).</p>
</li>
</ul>
<pre><code class="language-julia">N &#61; 20
L &#61; 4
s &#61; range&#40;0.0, 1.0, length&#61;N&#41;
x &#61; L/2 * &#40;1 .&#43; cos.&#40;π * s&#41;&#41;
#x &#61; L/2 * &#40; 1 .&#43; &#91;cos&#40;&#40;2i - 1&#41;/&#40;2N&#41; * π&#41; for i in 1:N&#93;&#41;
scatter&#40;x, zero&#40;x&#41;, markersize&#61;4, legend&#61;false&#41;
scatter&#33;&#40;x,x-&gt;√&#40;&#40;L/2&#41;^2-&#40;x-L/2&#41;^2&#41;, markersize&#61;3, legend&#61;false&#41;
plot&#33;&#40;title&#61;&quot;Distribuição dos pontos de Chebyshev&quot;, titlefont&#61;10, size&#61;&#40;600,300&#41;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c12/1201-EDP_e_diferencas_finitas/code/images/1201-EDP_e_diferencas_finitas_3_1.png" alt="">
<h3 id="discretização_espacial_bidimensional_uniforme"><a href="#discretização_espacial_bidimensional_uniforme" class="header-anchor">Discretização espacial bidimensional uniforme</a></h3>
<ul>
<li><p>Essa ideia pode ser estendida a dimensões maiores de forma natural.</p>
</li>
<li><p>No caso de um domínio bidimensional retangular \(\Omega = (0,L_x) \times (0,L_y)\), considerando espaçamentos uniformes \(h_x\) e \(h_y\), com \(N_x\) pontos no eixo \(x\) e \(N_y\) pontos no eixo \(y\), temos</p>
</li>
</ul>
\[ 0 = x_1 < \ldots < x_{N_x} = L_x, \quad (N_x-1)h_x = L_x, \qquad 0 = y_1 < \ldots < y_{N_y} = L_y, \quad (N_y-1)h_y = L_y
\]
<pre><code class="language-julia">L_x &#61; 4.0
L_y &#61; 2.0
N_x &#61; 20
N_y &#61; 10
x &#61; range&#40;0.0, L_x, length&#61;N_x&#41;
y &#61; range&#40;0.0, L_y, length&#61;N_y&#41;
scatter&#40;x, repeat&#40;y&#39;,length&#40;x&#41;&#41;, legend&#61;false, color&#61;1, size&#61;&#40;600,300&#41;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c12/1201-EDP_e_diferencas_finitas/code/images/1201-EDP_e_diferencas_finitas_4_1.png" alt="">
<h3 id="discretização_bidimensional_não-uniforme"><a href="#discretização_bidimensional_não-uniforme" class="header-anchor">Discretização bidimensional não-uniforme</a></h3>
<ul>
<li><p>Da mesma forma, podemos considerar malhas não-uniformes</p>
</li>
<li><p>A malha pode ser não-uniforme na direção de ambos os eixos ou em apenas um deles</p>
</li>
</ul>
<pre><code class="language-julia">L_x &#61; 4.0
L_y &#61; 2.0
N_x &#61; 20
N_y &#61; 10
x &#61; range&#40;0.0, L_x, length&#61;N_x&#41;
s &#61; range&#40;0.0, 1.0, length&#61;N_y&#41;
y &#61; L/2 * &#40;1 .&#43; cos.&#40;π * s&#41;&#41;
scatter&#40;x, repeat&#40;y&#39;,length&#40;x&#41;&#41;, legend&#61;false, color&#61;1, size&#61;&#40;600,300&#41;,
    xlabel&#61;&quot;x&quot;, ylabel&#61;&quot;y&quot;, title&#61;&quot;Malha não-uniforme em y&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c12/1201-EDP_e_diferencas_finitas/code/images/1201-EDP_e_diferencas_finitas_5_1.png" alt="">
<pre><code class="language-julia">L_x &#61; 4.0
L_y &#61; 2.0
N_x &#61; 20
N_y &#61; 10
r &#61; range&#40;0.0, 1.0, length&#61;N_x&#41;
s &#61; range&#40;0.0, 1.0, length&#61;N_y&#41;
x &#61; L/2 * &#40;1 .&#43; cos.&#40;π * r&#41;&#41;
y &#61; L/2 * &#40;1 .&#43; cos.&#40;π * s&#41;&#41;
scatter&#40;x, repeat&#40;y&#39;,length&#40;x&#41;&#41;, legend&#61;false, color&#61;1, size&#61;&#40;600,300&#41;,
    xlabel&#61;&quot;x&quot;, ylabel&#61;&quot;y&quot;, title&#61;&quot;Malha não-uniforme em ambas as direções&quot;, titlefont&#61;10&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c12/1201-EDP_e_diferencas_finitas/code/images/1201-EDP_e_diferencas_finitas_6_1.png" alt="">
<h2 id="resolvendo_edps_em_julia"><a href="#resolvendo_edps_em_julia" class="header-anchor">Resolvendo EDPs em Julia</a></h2>
<ul>
<li><p>O artigo <a href="https://nextjournal.com/sosiris-de/pde-2018">Solving PDEs in Julia &#40;JuliaCon 2018 workshop&#41;, por Chris Rackauckas</a> dá uma boa ideia de métodos e exemplos de resolução de EDPs em Julia.</p>
</li>
<li><p>O artigo está um pouco desatualizado, pois é de 2018 e a linguagem e, principalmente, os pacotes de resolução de equações diferenciais têm evoluido muito rapidamente.</p>
</li>
<li><p>Mas ainda assim o artigo pode ser útil.</p>
</li>
<li><p>Um novo artigo, com o mesmo espírito desse, está em vias de ser escrito.</p>
</li>
</ul>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c12/1202-EDP_advecao"><kbd>→</kbd> 12.2. Equação de adveçcão</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: July 19, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/modelagem_matematica/libs/katex/katex.min.js"></script>
        <script src="/modelagem_matematica/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
