<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Modelos individuais</title>  
  <link rel="shortcut icon" type="image/png" href="/modelagem_matematica/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/modelagem_matematica/css/base.css"/>
  
  <script src="/modelagem_matematica/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/highlight/github.min.css">
    <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
    <script src="/modelagem_matematica/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/modelagem_matematica/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Modelos em Eletrônica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c08/0801-Modelo_diodo">8.1. Modelagem da relação voltagem-corrente de um diodo</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Reações Químicas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0901-Lei_acao_de_massas">9.1. Lei de ação de massas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0902-Reacoes_enzimaticas">9.2. Modelagem de reações enzimática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0903-Isomerizacao">9.3. Lupulagem e a conversão de humulone em iso-humulone considerando saturação</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Modelos Epidemiológicos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1001-Modelos_epidemiologicos_compartimentais">10.1. Modelos epidemiológicos compartimentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1002-Ajuste_SIR">10.2. Ajustando um modelo SIR a uma epidemia de Influenza</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1004-Individual_estocastico">10.4. Modelos individuais</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Séries de Fourier e Aplicações</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1102-Transformada_discreta_Fourier">11.2. Transformada discreta de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/modelagem_matematica/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier"><kbd>→</kbd> 11.1. Séries de Fourier</a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c10/1004-Individual_estocastico.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c10/1004-Individual_estocastico.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/modelagem_matematica/generated/jupytered/c10/1004-Individual_estocastico.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/modelagem_matematica/src/jupyter/c10/1004-Individual_estocastico.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1 id="get_title"><a href="#get_title" class="header-anchor">10.4. Modelos individuais</a></h1>
<ul>
<li><p>Modelos onde cada indivíduo é tratado como uma variável, com características próprias.</p>
</li>
<li><p>Podem ser mapeamentos &#40;discretos no tempo&#41; ou sistemas de equações diferenciais &#40;contínuos no tempo&#41;. </p>
</li>
<li><p>Podem ser determinísticos ou estocásticos.</p>
</li>
<li><p>Vamos ver, concretamente, um modelo individual discreto estocástico.</p>
</li>
</ul>
<pre><code class="language-julia">using LinearAlgebra
using Random
using StatsBase
using Plots</code></pre>
<h2 id="cenário"><a href="#cenário" class="header-anchor">Cenário</a></h2>
<ul>
<li><p>Criamos um &quot;cenário&quot;, com um determinado número <code>N</code> de indivíduos e vetores de comprimento <code>N</code> com os atributos de cada indivíduo.</p>
</li>
<li><p>Há várias formas de se fazer isso, dependendo do nível de detalhamento que queiramos fazer.</p>
</li>
<li><p>Podemos determinar a idade de cada indivíduo, o grau de suscetibilidade e de infectividade de cada indivíduo, a posição espacial onde o indivíduo se encontra em cada instante, etc..</p>
</li>
<li><p>No exemplo a seguir, vamos considerar, apenas, graus de suscetibilidade e de infectividade.</p>
</li>
<li><p>Além disso, precisamos de um vetor indicando o estágio, ou estado, da doença em cada indivíduo.</p>
</li>
</ul>
<h3 id="atributos"><a href="#atributos" class="header-anchor">Atributos</a></h3>
<ul>
<li><p>Vamos definir, então, um vetor <code>estado</code>, onde cada elemento do vetor representa o estágio epidemiológico de cada indivíduo. Vamos considerar, a título de exemplo, três possíveis estados: <strong>suscetível,</strong> <strong>infectado</strong> e <strong>recuperado</strong>. Vamos representá-los, no vetor, pelos inteiros <code>0</code>, <code>1</code> e <code>2</code>, respectivamente.</p>
</li>
<li><p>O grau de suscetibilidade de cada indivíduo é representado por um real positivo. Isso será representado por um vetor <code>suscetibilidade</code> de números em ponto flutuante. Há estudos indicando que esse grau segue uma distribuição beta, na população. Para simplificar, vamos apenas usar uma distribuição uniforme entre dois números positivos.</p>
</li>
<li><p>Idem para o vetor <code>infectividade</code>.</p>
</li>
<li><p>Da mesma forma, consideramos um vetor <code>recuperacao</code>, indicando a taxa de recuperação de cada indivíduo, no caso dele vir a ser infectados. Vamos considerar essa atributo correlacionado ao atributo de suscetibilidade.</p>
</li>
</ul>
<h3 id="parâmetros_epidemiológicos_globais"><a href="#parâmetros_epidemiológicos_globais" class="header-anchor">Parâmetros epidemiológicos globais</a></h3>
<ul>
<li><p>Em relação aos outros parâmetros epidemiológicos, consideramos os seguintes.</p>
</li>
<li><p>Uma taxa \(\tau\) de contágios por contato próximo.</p>
</li>
<li><p>Uma taxa média \(\kappa\) de número de contatos próximos por indivíduo.</p>
</li>
</ul>
<pre><code class="language-julia"># Cenário

N &#61; 10_000 # população
estado &#61; zeros&#40;Int,N&#41;
infectividade &#61; 0.5 .&#43; rand&#40;N&#41;
suscetibilidade &#61; 0.5 .&#43; rand&#40;N&#41;
recuperacao &#61; 1 ./ &#40;1 .&#43; 9 * rand&#40;N&#41;&#41; # distribuição uniforme entre 1 e 10 dias de recuperação
recuperacao &#61; 1 ./ &#40;1 .&#43; 6 * rand&#40;N&#41; .* suscetibilidade&#41; # distribuição entre 1 e 9, correlacionada com a suscetibilidade</code></pre>
<pre><code class="language-julia">10000-element Vector&#123;Float64&#125;:
 0.3512647726380822
 0.22178354767138586
 0.1828262770204902
 0.15496799650440546
 0.31915011832406576
 0.8795454347513427
 0.1337346035422036
 0.7289188356437403
 0.6006042765187306
 0.10936702545497624
 ⋮
 0.2232304093874936
 0.12863751567461906
 0.3811599642501084
 0.24503797070905461
 0.2577004209284512
 0.2628714359655289
 0.17437929509313205
 0.7168404588190401
 0.22020614487043197</code></pre>
<pre><code class="language-julia">τ &#61; 0.02 # taxa de contágio por contato próximo
κ &#61; 20 # número médio de contatos por indivíduo
nothing</code></pre>
<h2 id="dinâmica_da_epidemia"><a href="#dinâmica_da_epidemia" class="header-anchor">Dinâmica da epidemia</a></h2>
<ul>
<li><p>Este é um modelo SIR individual.</p>
</li>
<li><p>Cada indivíduo suscetível pode se tornar infectado através do contato com indivíduos infectados.</p>
</li>
<li><p>E cada indivíduo infectado se recupera de acordo com a sua taxa de recuperação.</p>
</li>
<li><p>Este é um modelo discreto no tempo, com cada iteração correspondendo a um dia de evolução.</p>
</li>
<li><p>Também é um modelo estocástico. A cada passo de tempo, cada indivíduo suscetível <em>pode</em> se tornar infectado dependendo de um número sorteado aleatoriamente ser maior ou não do que a <em>força de infecção</em> agindo no indivíduo, ponderada pelo grau de suscetibilidade do indivíduo.</p>
</li>
<li><p>E cada indivíduo infectado <em>pode</em> se recuperar dependendo de um número sorteado aleatoriamente ser menor ou não do que a taxa de recuperação do indivíduo.</p>
</li>
</ul>
<h3 id="força_de_infecção"><a href="#força_de_infecção" class="header-anchor">Força de infecção</a></h3>
<ul>
<li><p>A força de infecção \(\lambda\) de um indivíduo é calculada de acordo com o grau de infectividade dos indivíduos infectados que tenham tido contato com o indivíduo em questão.</p>
</li>
<li><p>No caso compartimental, temos \(\lambda \sim \beta I / N = \kappa \tau I / N\), onde \(\kappa\) é o número médio de contatos por indivíduo e \(I / N\) é a fração desses que é de contatos com infectados. No caso individual, o número de contatos \(\kappa = \kappa_i\) é individualizado e a fração \(I/N\) de contatos infectados é \(\sum_j I_j / \kappa_j\), onde \(I_j\) indica a infectividade &#40;ou é zero se o \(j\)-ésimo contato não está infectado&#41;. Logo, o termo \(\kappa_j\) &#40;está implícito&#41; se cancela e ficamos com</p>
</li>
</ul>
\[
\lambda = \tau * \sum_{\textrm{contatos com infectados j}} \mathrm{infectividade}[j].
\]
<ul>
<li><p>No caso contínuo no tempo, temos \(S' = - \lambda S\), o que nos dá, num intervalo de tempo \(\Delta t\),</p>
</li>
</ul>
\[
S(t + \Delta t) = S(t) e^{-\lambda \Delta t}.
\]
<ul>
<li><p>Assim, no caso discreto no tempo, a taxa de variação de suscetíveis/infectados é proporcional à</p>
</li>
</ul>
\[
e^{-\lambda \Delta t}
\]
<ul>
<li><p>Quando maior \(\lambda\), menor \(e^{-\lambda \Delta t}\) e maior a probabilidade de um determinado indivíduo suscetível se tornar infectado.</p>
</li>
<li><p>No caso estocástico discreto, isso é alcançado sorteando-se, para cada indivíduo suscetível, um número aleatório uniformemente entre zero e um e verificando se esse número é maior do que \(e^{-\lambda \Delta t}\) ou não. Caso positivo, o indivíduo se torna infectado. Caso contrário, permanece suscetível.</p>
</li>
</ul>
<h3 id="recuperação"><a href="#recuperação" class="header-anchor">Recuperação</a></h3>
<ul>
<li><p>Da mesma forma, no caso compartimental contínuo, a recuperação é determinada pela componente \(I' = - \gamma I\).</p>
</li>
<li><p>Após um tempo \(\Delta t\), temos uma variação no número de infectados, por conta da recuperação, da ordem de</p>
</li>
</ul>
\[
I(t + \Delta t) = I(t) e^{-\gamma \Delta t}.
\]
<ul>
<li><p>No caso temporal discreto, vemos que a recuperação, a cada passo de tempo \(\Delta t\), é proporcional a um fator dependente da taxa de recuperação \(\gamma_i\) de cada indivíduo:</p>
</li>
</ul>
\[
e^{-\gamma_i \Delta t}.
\]
<ul>
<li><p>Quanto maior a taxa de recuperação \(\gamma_i\), maiores as chances do indivíduo se recuperar.</p>
</li>
<li><p>Na simulação, sorteamos, então, um número aleatório \(r\) distribuído uniformemente entre \(0\) e \(1\) e vericamos se este número é maior ou menor do que \(e^{-\gamma_i \Delta t}\). Caso positivo, o indivíduo se recupera, caso contrário, permanece infectado.</p>
</li>
</ul>
<h3 id="contatos"><a href="#contatos" class="header-anchor">Contatos</a></h3>
<ul>
<li><p>Os contatos entre os indivíduos são definidos aleatoriamente a cada passo. Há várias estruturas que podemos usar &#40;aglomerados residenciais, aglomerados escolares, aglomerados em postos de trabalho, redes de contato entre amigos, encontros aleatórios entre a população em geral - e.g. em meios de transporte, lojas de comércio, parques, shows, etc.&#41;.</p>
</li>
<li><p>Para simplificar, no entanto, vamos considerar, apenas, aglomerados arbitrários sorteados a cada passo de tempo.</p>
</li>
</ul>
<h2 id="quantidades_de_interesse"><a href="#quantidades_de_interesse" class="header-anchor">Quantidades de interesse</a></h2>
<ul>
<li><p>Para simplificar, não vamos guardar o histórico de cada indivíduo. O vetor com o estado epidemiológico da população será atualizado a cada passo de tempo.</p>
</li>
<li><p>Vamos guardar o histórico, apenas, do total de indivíduos em cada estágio epidemiológico.</p>
</li>
</ul>
<h2 id="simulação"><a href="#simulação" class="header-anchor">Simulação</a></h2>
<ul>
<li><p>Abaixo implementamos o modelo descrito acima.</p>
</li>
</ul>
<pre><code class="language-julia"># Evolução
num_dias &#61; 180
dt &#61; 1/2
tempos &#61; range&#40;0.0, num_dias, step &#61; dt&#41;
num_iter &#61; length&#40;tempos&#41;

# inicialização
ninf0 &#61; 2
inf0 &#61; sample&#40;1:N, ninf0&#41;
estado &#61; zeros&#40;Int, N&#41;
estado&#91;inf0&#93; .&#61; 1

# compartimentos
suscetiveis &#61; zeros&#40;Int, num_iter&#41;
infectados &#61; zeros&#40;Int, num_iter&#41;
recuperados &#61; zeros&#40;Int, num_iter&#41;
suscetiveis&#91;1&#93; &#61; count&#40;estado .&#61;&#61; 0&#41;
infectados&#91;1&#93; &#61; count&#40;estado .&#61;&#61; 1&#41;
recuperados&#91;1&#93; &#61; count&#40;estado .&#61;&#61; 2&#41;

# força de infecção
λ &#61; zeros&#40;N&#41;

# contatos
contatos &#61; collect&#40;1:N&#41;

# evolução
for n in 2:num_iter
    λ .&#61; 0.0
    shuffle&#33;&#40;contatos&#41;
    i &#61; 1
    while i ≤ N
        ip &#61; min&#40;i &#43; rand&#40;div&#40;κ, 2&#41;:2κ&#41;, N&#41;
        if any&#40;&#61;&#61;&#40;1&#41;, estado&#91;contatos&#91;i:ip&#93;&#93;&#41;
            λ&#91;contatos&#91;i:ip&#93;&#93; .&#61; τ * sum&#40;infectividade&#91;contatos&#91;j&#93;&#93; for j in i:ip if estado&#91;contatos&#91;j&#93;&#93; &#61;&#61; 1&#41;
        end
        i &#61; ip &#43; 1
    end
    for i in 1:N
        if estado&#91;i&#93; &#61;&#61; 0 &amp;&amp; rand&#40;&#41; &gt; exp&#40;-λ&#91;i&#93; * dt&#41;
            estado&#91;i&#93; &#61; 1
        elseif estado&#91;i&#93; &#61;&#61; 1 &amp;&amp; rand&#40;&#41; &gt; exp&#40;-recuperacao&#91;i&#93; * dt&#41;
            estado&#91;i&#93; &#61; 2
        end        
    end
    suscetiveis&#91;n&#93; &#61; count&#40;estado .&#61;&#61; 0&#41;
    infectados&#91;n&#93; &#61; count&#40;estado .&#61;&#61; 1&#41;
    recuperados&#91;n&#93; &#61; count&#40;estado .&#61;&#61; 2&#41;
end</code></pre>
<pre><code class="language-julia">plot&#40;title &#61; &quot;Evolução epidemiológica&quot;, titlefont &#61; 12, xaxis &#61; &quot;dia&quot;, yaxis &#61; &quot;número de indivíduos&quot;&#41;
plot&#33;&#40;tempos, suscetiveis, label &#61; &quot;suscetíveis&quot;&#41;
plot&#33;&#40;tempos, infectados, label &#61; &quot;infectados&quot;&#41;
plot&#33;&#40;tempos, recuperados, label &#61; &quot;recuperados&quot;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c10/1004-Individual_estocastico/code/images/1004-Individual_estocastico_5_1.png" alt="">
<pre><code class="language-julia">plot&#40;title &#61; &quot;Evolução epidemiológica&quot;, titlefont &#61; 12, xaxis &#61; &quot;dia&quot;, yaxis &#61; &quot;número de indivíduos&quot;&#41;
plot&#33;&#40;tempos, infectados, ylim &#61; &#40;0.0, min&#40;1.5 * maximum&#40;infectados&#41;, N&#41;&#41;, label &#61; &quot;infectados&quot;, color &#61; 2&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c10/1004-Individual_estocastico/code/images/1004-Individual_estocastico_6_1.png" alt="">
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Implemente uma versão SEIR do modelo individual discreto estocástico descrito acima.</p>
</li>
</ol>
<h2 id="referências"><a href="#referências" class="header-anchor">Referências</a></h2>
<ul>
<li><p><a href="https://press.princeton.edu/books/hardcover/9780691116174/modeling-infectious-diseases-in-humans-and-animals">M. J. Keeling &amp; P. Rohani &#40;2007&#41;, Modeling Infectious Diseases in Humans and Animals, Princeton University Press.</a></p>
</li>
</ul>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier"><kbd>→</kbd> 11.1. Séries de Fourier</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: July 10, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/modelagem_matematica/libs/katex/katex.min.js"></script>
        <script src="/modelagem_matematica/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
