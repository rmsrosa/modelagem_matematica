<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Validação de modelos</title>  
  <link rel="shortcut icon" type="image/png" href="/modelagem_matematica/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/modelagem_matematica/css/base.css"/>
  
  <script src="/modelagem_matematica/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/highlight/github.min.css">
    <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
    <script src="/modelagem_matematica/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/modelagem_matematica/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Modelos em Eletrônica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c08/0801-Modelo_diodo">8.1. Modelagem da relação voltagem-corrente de um diodo</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Reações Químicas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0901-Lei_acao_de_massas">9.1. Lei de ação de massas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0902-Reacoes_enzimaticas">9.2. Modelagem de reações enzimática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0903-Isomerizacao">9.3. Lupulagem e a conversão de humulone em iso-humulone considerando saturação</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Modelos Epidemiológicos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1001-Modelos_epidemiologicos_compartimentais">10.1. Modelos epidemiológicos compartimentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1002-Ajuste_SIR">10.2. Ajustando um modelo SIR a uma epidemia de Influenza</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/modelagem_matematica/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos"><kbd>→</kbd> 6.3. Comparação de modelos</a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c06/0602-Validacao_do_modelo.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c06/0602-Validacao_do_modelo.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/modelagem_matematica/generated/jupytered/c06/0602-Validacao_do_modelo.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/modelagem_matematica/src/jupyter/c06/0602-Validacao_do_modelo.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1>6.2. Validação de modelos</h1>
<ul>
<li><p>Validação cruzada</p>
</li>
<li><p>Validação cruzada com dobras</p>
</li>
</ul>
<pre><code class="language-julia">using Random
using Statistics
using LinearAlgebra
using Plots
theme&#40;:ggplot2&#41;</code></pre>
<h2 id="validação_cruzada"><a href="#validação_cruzada" class="header-anchor">Validação cruzada</a></h2>
<ul>
<li><p>O objetivo aqui não é apenas achar os parâmetros do modelo que melhor se ajustam aos dados, mas verificar se ele é um bom modelo para fazer previsões/predições.</p>
</li>
<li><p>A ideia é separar parte dos dados para o ajuste &#40;treino&#41; e o restante para validação &#40;teste&#41;.</p>
</li>
<li><p>Separações típicas são da ordem de 75&#37; dos dados para o ajuste e 25&#37; para teste.</p>
</li>
<li><p>Compara-se o RMS do ajuste com o RMS do teste:</p>
<ul>
<li><p>Se o RMS do teste estiver próximo do RMS do ajuste, considera-se que o modelo tem boa capacidade de previsão.</p>
</li>
<li><p>Se o RMS do teste for muito maior, o modelo não tem boa capacidade de previsão.</p>
</li>
</ul>
</li>
</ul>
<h2 id="validação_cruzada_com_dobras_k-fold_cross-validation"><a href="#validação_cruzada_com_dobras_k-fold_cross-validation" class="header-anchor">Validação cruzada com dobras <em>&#40;k-fold cross-validation&#41;</em></a></h2>
<ul>
<li><p>Nesse caso, a ideia é fazer várias validações cruzadas.</p>
</li>
<li><p>Divide-se os dados em \(J\) partes iguais &#40;chamadas dobras, ou <em>folds</em>&#41;, digamos, \(J=5\) ou \(10\).</p>
</li>
<li><p>Em cada uma de \(J\) etapas, seleciona-se 1 das dobras para teste e as outras \(J-1\) para o ajuste.</p>
</li>
<li><p>Ao final, temos \(J\) conjuntos \(\beta^{j}\) de parâmetros, cada um como melhor ajuste baseado nos seus dados de treino, assim como \(J\) valores de RMS do ajuste e \(J\) de RMS do teste.</p>
</li>
<li><p>Se os valores dos parâmetros, nas diferentes dobras, estiverem próximos uns dos outros, isso é um indicativo da <strong>estabilidade</strong> do modelo.</p>
</li>
</ul>
<ul>
<li><p>Ao final, se o modelo for estável, podemos selecionar os parâmetros de várias formas:</p>
<ul>
<li><p>Fazendo um novo ajuste com todos os dados;</p>
</li>
</ul>
<ul>
<li><p>Tomando uma média, entre as várias dobras, de cada parâmetro; ou</p>
</li>
</ul>
<ul>
<li><p>Selecionado uma ou tomando uma média entre algumas dobras dentre as mais estáveis e com melhor qualidade preditiva.</p>
</li>
</ul>
</li>
<li><p>Considera-se o erro RMS da validação cruzada como a média quadrádica dos erros de cada dobra </p>
</li>
</ul>
\[ \epsilon = \sqrt{\frac{1}{J}\sum_j \epsilon_j^2}.
\]
<h2 id="exemplo_sintético"><a href="#exemplo_sintético" class="header-anchor">Exemplo sintético</a></h2>
<p>Neste exemplo sintético, vamos </p>
<ul>
<li><p>Construir dados sintéticos a partir de perturbações aleatórias em torno de uma determinada função.</p>
</li>
<li><p>Perturbações uniformemente distribuídas entre \(\pm 0.3\) na abscissa.</p>
</li>
<li><p>Perturbações uniformemente distribuídas entre \(\pm 1\) na ordenada.</p>
</li>
<li><p>Em seguida, usaremos mínimos quadrados para ajustar um polinômio de grau três.</p>
</li>
<li><p>Posteriormente, mínimos quadrados para ajustar polinômios de diversos graus.</p>
</li>
</ul>
<h3 id="função_para_cálculo_das_medidas_de_qualidade_do_modelo"><a href="#função_para_cálculo_das_medidas_de_qualidade_do_modelo" class="header-anchor">Função para cálculo das medidas de qualidade do modelo</a></h3>
<pre><code class="language-julia">function info_ajuste&#40;dados_x, dados_y, model_y, k&#41;
    N &#61; length&#40;dados_x&#41;
    y_mean &#61; mean&#40;dados_y&#41;
    residuos &#61; model_y - dados_y
    ss &#61; norm&#40;residuos&#41;^2
    rms &#61; sqrt&#40;ss/N&#41;
    ss_y &#61; norm&#40;dados_y&#41;^ 2
    rms_y &#61; sqrt&#40;ss_y/N&#41;
    ss_rel &#61; ss/ss_y
    rms_rel &#61; sqrt&#40;ss_rel&#41;
    ss_tot &#61; N*var&#40;dados_y&#41;
    ss_reg &#61; norm&#40;model_y .- y_mean&#41;^2
    r_sq &#61; ss_reg/ss_tot
    r_sq_aj &#61; 1 - &#40;1 - r_sq&#41;*&#40;N-1&#41;/&#40;N-k&#41;
    
    return &#40;
        residuos&#61;residuos, rms&#61;rms, rms_rel&#61;rms_rel, ss&#61;ss, ss_rel&#61;ss_rel,
        r_sq&#61;r_sq, r_sq_aj&#61;r_sq_aj
    &#41;
end</code></pre>
<pre><code class="language-julia">info_ajuste &#40;generic function with 1 method&#41;</code></pre>
<h3 id="definição_do_modelos_e_dos_dados"><a href="#definição_do_modelos_e_dos_dados" class="header-anchor">Definição do modelos e dos dados</a></h3>
<pre><code class="language-julia">f_modelo&#40;x, β&#41; &#61; β ⋅ &#91;x^j for j in 0:length&#40;β&#41;-1&#93;
f_dados&#40;x,β&#41; &#61; exp&#40;β&#91;4&#93;*x&#41; * &#40;β&#91;1&#93; &#43; β&#91;2&#93;*x &#43; β&#91;3&#93;*x^2 &#43; β&#91;4&#93;*x^3&#41;
β̲ &#61; &#91;5.2, 0.5, -0.45, 0.05&#93;
x &#61; -1.0:0.1:8.0
nothing</code></pre>
<pre><code class="language-julia">dados_x &#61; collect&#40;0.0:0.4:7.6&#41; .&#43; 0.1 * randn&#40;MersenneTwister&#40;15001&#41;, 20&#41;
dados_y &#61; f_dados.&#40;dados_x, Ref&#40;β̲&#41;&#41; .&#43; 0.5 * randn&#40;MersenneTwister&#40;15021&#41;, 20&#41;
nothing</code></pre>
<pre><code class="language-julia">plot&#40;xlim&#61;&#40;-1, 8&#41;, ylim&#61;&#40;1, 9&#41;, legend&#61;:topleft,
    titlefont&#61;10, title&#61;&quot;função para a amostra e dados sintéticos&quot;&#41;
plot&#33;&#40;dados_x, dados_y, seriestype&#61;:scatter, label&#61;&quot;amostra&quot;&#41;
plot&#33;&#40;x, x -&gt; f_dados&#40;x, β̲&#41;, label&#61;&quot;função para a amostra&quot;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0602-Validacao_do_modelo/code/images/0602-Validacao_do_modelo_5_1.png" alt="">
<h3 id="selecionando_os_dados_de_treino_e_de_teste"><a href="#selecionando_os_dados_de_treino_e_de_teste" class="header-anchor">Selecionando os dados de treino e de teste</a></h3>
<pre><code class="language-julia">indices  &#61; shuffle&#40;MersenneTwister&#40;15041&#41;, 1:length&#40;dados_x&#41;&#41;
treino_x &#61; dados_x&#91;sort&#40;indices&#91;1:3*div&#40;end,4&#41;&#93;&#41;&#93;
treino_y &#61; dados_y&#91;sort&#40;indices&#91;1:3*div&#40;end,4&#41;&#93;&#41;&#93;
teste_x &#61; dados_x&#91;sort&#40;indices&#91;3*div&#40;end,4&#41;&#43;1:end&#93;&#41;&#93;
teste_y &#61; dados_y&#91;sort&#40;indices&#91;3*div&#40;end,4&#41;&#43;1:end&#93;&#41;&#93;
nothing</code></pre>
<pre><code class="language-julia">plot&#40;xlim&#61;&#40;-1, 8&#41;, ylim&#61;&#40;1, 9&#41;, legend&#61;:topleft,
    titlefont&#61;10, title&#61;&quot;função para a amostra e dados sintéticos&quot;&#41;
plot&#33;&#40;treino_x, treino_y, seriestype&#61;:scatter, label&#61;&quot;amostra treino&quot;, color&#61;1&#41;
plot&#33;&#40;teste_x, teste_y, seriestype&#61;:scatter, label&#61;&quot;amostra teste&quot;, color&#61;:orange&#41;
plot&#33;&#40;x, x -&gt; f_dados&#40;x, β̲&#41;, label&#61;&quot;função para a amostra&quot;, color&#61;2&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0602-Validacao_do_modelo/code/images/0602-Validacao_do_modelo_7_1.png" alt="">
<h3 id="modelo_polinomial_de_grau_baixo"><a href="#modelo_polinomial_de_grau_baixo" class="header-anchor">Modelo polinomial de grau baixo</a></h3>
<ul>
<li><p>O modelo abaixo, após  o treino, apresentada um bom resultado no teste, com base no R quadrado.</p>
</li>
</ul>
<pre><code class="language-julia">A &#61; reduce&#40;hcat, &#91;treino_x.^j for j&#61;0:3&#93;&#41;
β̂ &#61; A \ treino_y
info_treino &#61; info_ajuste&#40;treino_x, treino_y, f_modelo.&#40;treino_x, Ref&#40;β̂&#41;&#41;, length&#40;β̂&#41;&#41;
info_teste &#61; info_ajuste&#40;teste_x, teste_y, f_modelo.&#40;teste_x, Ref&#40;β̂&#41;&#41;, length&#40;β̂&#41;&#41;
nothing</code></pre>
<pre><code class="language-julia">plot&#40;xlim&#61;&#40;-1, 8&#41;, ylim&#61;&#40;1, 9&#41;, legend&#61;:topleft,
    titlefont&#61;10, title&#61;&quot;Modelo ajustado e dados sintéticos&quot;&#41;
plot&#33;&#40;treino_x, treino_y, seriestype&#61;:scatter, label&#61;&quot;amostra treino&quot;, color&#61;1&#41;
plot&#33;&#40;teste_x, teste_y, seriestype&#61;:scatter, label&#61;&quot;amostra teste&quot;, color&#61;:orange&#41;
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂&#41;,
    label&#61;&quot;resultado do treino &#40;RMS &#61; &#36;&#40;round&#40;info_treino.rms, digits &#61; 3&#41;&#41;, &quot; * 
        &quot;R² &#61; &#36;&#40;round&#40;info_treino.r_sq,digits&#61;3&#41;&#41;, &quot; * 
        &quot;R²_aj &#61; &#36;&#40;round&#40;info_treino.r_sq_aj,digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂&#41;,
    label&#61;&quot;resultado do teste &#40;RMS &#61; &#36;&#40;round&#40;info_teste.rms, digits &#61; 3&#41;&#41;, &quot; *
        &quot;R² &#61; &#36;&#40;round&#40;info_teste.r_sq,digits&#61;3&#41;&#41;, &quot; *
        &quot;R²_aj &#61; &#36;&#40;round&#40;info_teste.r_sq_aj,digits&#61;3&#41;&#41;&#41;&quot;,
    color&#61;3, linestyle&#61;:dash&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0602-Validacao_do_modelo/code/images/0602-Validacao_do_modelo_9_1.png" alt="">
<h3 id="modelo_polinomial_de_grau_alto"><a href="#modelo_polinomial_de_grau_alto" class="header-anchor">Modelo polinomial de grau alto</a></h3>
<ul>
<li><p>O modelo abaixo, após  o treino, apresenta um resultado ruim no teste, com base no R-quadrado.</p>
</li>
</ul>
<pre><code class="language-julia">A &#61; reduce&#40;hcat, &#91;treino_x.^j for j&#61;0:12&#93;&#41;
β̂ &#61; A \ treino_y
info_treino &#61; info_ajuste&#40;treino_x, treino_y, f_modelo.&#40;treino_x, Ref&#40;β̂&#41;&#41;, length&#40;β̂&#41;&#41;
info_teste &#61; info_ajuste&#40;teste_x, teste_y, f_modelo.&#40;teste_x, Ref&#40;β̂&#41;&#41;, length&#40;β̂&#41;&#41;
nothing</code></pre>
<pre><code class="language-julia">plot&#40;xlim&#61;&#40;-1,8&#41;, ylim&#61;&#40;1,9&#41;, legend&#61;:topleft,
    titlefont&#61;10, title&#61;&quot;Modelo ajustado e dados sintéticos&quot;&#41;
plot&#33;&#40;treino_x, treino_y, seriestype&#61;:scatter, label&#61;&quot;amostra treino&quot;, color&#61;1&#41;
plot&#33;&#40;teste_x, teste_y, seriestype&#61;:scatter, label&#61;&quot;amostra teste&quot;, color&#61;:orange&#41;
plot&#33;&#40;x,x-&gt;f_modelo&#40;x,β̂&#41;,
    label&#61;&quot;resultado do treino &#40;RMS &#61; &#36;&#40;round&#40;info_treino.rms, digits &#61; 3&#41;&#41;, &quot; * 
        &quot;R² &#61; &#36;&#40;round&#40;info_treino.r_sq,digits&#61;3&#41;&#41;, &quot; * 
        &quot;R²_aj &#61; &#36;&#40;round&#40;info_treino.r_sq_aj,digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;
plot&#33;&#40;x,x-&gt;f_modelo&#40;x,β̂&#41;,
    label&#61;&quot;resultado do teste &#40;RMS &#61; &#36;&#40;round&#40;info_teste.rms, digits &#61; 3&#41;&#41;, &quot; *
        &quot;R² &#61; &#36;&#40;round&#40;info_teste.r_sq,digits&#61;3&#41;&#41;, &quot; *
        &quot;R²_aj &#61; &#36;&#40;round&#40;info_teste.r_sq_aj,digits&#61;3&#41;&#41;&#41;&quot;,
    color&#61;3, linestyle&#61;:dash&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0602-Validacao_do_modelo/code/images/0602-Validacao_do_modelo_11_1.png" alt="">
<ul>
<li><p>Observe, nesse caso, que, apesar de estarmos no contexto de regressão linear, o valor de R-quadrado <em>do teste</em> está totalmente fora do intervalo \(0 \leq R^2 \leq 1\).</p>
</li>
<li><p>Mas não é nenhuma contradição. O ajuste foi feito com os dados do treino e esse resultado vale apenas para o R-quadrado <em>do treino</em>.</p>
</li>
<li><p>É mais um sinal de que o modelo fugiu do controle.</p>
</li>
</ul>
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Faça a validação cruzada das modelagens feitas nos exercícios do caderno 8, sobre <strong>Modelos redutíveis ao caso linear nos parâmetros e aplicações</strong>.</p>
</li>
<li><p>Faça a validação cruzada do modelos do exemplo sintético deste caderno.</p>
</li>
<li><p>Sobre o problema de modelagem de reação enzimática em fígados de porcos, também discutido no caderno 8, faça, ainda, a validação cruzada e a valiação cruzada com dobras de modelos polinomiais de diferentes ordens.</p>
</li>
</ol>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos"><kbd>→</kbd> 6.3. Comparação de modelos</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: June 21, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/modelagem_matematica/libs/katex/katex.min.js"></script>
        <script src="/modelagem_matematica/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
