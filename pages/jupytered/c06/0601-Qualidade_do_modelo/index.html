<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Qualidade do ajuste</title>  
  <link rel="shortcut icon" type="image/png" href="/modelagem_matematica/assets/images/favicon.png"/>
  <link rel="stylesheet" href="/modelagem_matematica/css/base.css"/>
  
  <script src="/modelagem_matematica/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/highlight/github.min.css">
    <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
    <script src="/modelagem_matematica/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/modelagem_matematica/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/modelagem_matematica/">Modelagem Matemática</a>
  </div>

  <br />

  <div class="books-subtitle">
    Notas de aula
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li><a href="/modelagem_matematica/pages/intro">Introdução</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE I</li>
    </div>
    <div class="menu-level-1">
    <li>1. Preliminares</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0101-Aspectos_curso">1.1. Aspectos do curso</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0102-Instalando_acessando_Julia">1.2. Instalando e acessando o Julia</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c01/0103-Primeiros_passos_Julia">1.3. Primeiros passos em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE II</li>
    </div>
    <div class="menu-level-1">
    <li>2. Princípios de Modelagem Matemática</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0201-Principios_basicos">2.1. Princípios básicos de modelagem</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c02/0202-Exemplos_tipos_modelagem">2.2. Exemplos de tipos de modelagem</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. Análise Dimensional</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0301-Quantidades_unidades_dimensoes">3.1. Quantidades, unidades e dimensões</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0302-BuckinghamPi">3.2. Análise dimensional e o Teorema de Buckingham-Pi</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c03/0303-Unidades_Julia">3.3. Trabalhando com unidades e dimensões em Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Ajuste de Parâmetros</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0401-Minimos_quadrados_ajuste">4.1. Mínimos quadrados e o ajuste de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0402-Exemplos_ajuste_linear">4.2. Exemplos de ajuste linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0403-Modelos_redutiveis_linear_aplicacoes">4.3. Modelos redutíveis ao caso linear nos parâmetros e aplicações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0404-Minimos_quadrados_nao_linear">4.4. Mínimos quadrados não-linear</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0405-Exemplos_ajuste_naolinear">4.5. Exemplos de ajuste não-linear de parâmetros</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0406-Redes_neurais">4.6. Redes neurais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c04/0407-Ajuste_em_redes_neurais">4.7. Ajuste de parâmetros em modelos de redes neurais</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Erros e Incertezas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0501-Erros_e_incertezas">5.1. Erros e incertezas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0502-Minimos_quadrados_verossimilhanca">5.2. Mínimos quadrados, maximização da verossimilhança e quantificação de incertezas em regressões lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Avaliação de Modelos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0601-Qualidade_do_modelo">6.1. Qualidade do ajuste</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo">6.2. Validação de modelos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c06/0603-Comparacao_de_modelos">6.3. Comparação de modelos</a></li>
    </div>
    <div class="menu-level-1">
    <li>PARTE III</li>
    </div>
    <div class="menu-level-1">
    <li>7. Mecânica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0701-Mecanica_Newtoniana">7.1. Mecânica Newtoniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0702-Mecanica_Lagrangiana">7.2. Mecânica Lagrangiana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0703-Conservacao_contexto_Newtoniano">7.3. Leis de conservação em um contexto Newtoniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0704-Conservacao_contexto_Lagrangiano">7.4. Leis de conservação em um contexto Lagrangiano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0705-Hamiltonianos">7.5. Hamiltonianos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0706-Pendulo">7.6. Análise do período de um pêndulo planar simples</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c07/0707-Pendulo_angulos_grandes">7.7. Experimentos com pêndulos</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Modelos em Eletrônica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c08/0801-Modelo_diodo">8.1. Modelagem da relação voltagem-corrente de um diodo</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Reações Químicas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0901-Lei_acao_de_massas">9.1. Lei de ação de massas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0902-Reacoes_enzimaticas">9.2. Modelagem de reações enzimática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c09/0903-Isomerizacao">9.3. Lupulagem e a conversão de humulone em iso-humulone considerando saturação</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Modelos Epidemiológicos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1001-Modelos_epidemiologicos_compartimentais">10.1. Modelos epidemiológicos compartimentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1002-Ajuste_SIR">10.2. Ajustando um modelo SIR a uma epidemia de Influenza</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c10/1003-Compartimentais_estruturados">10.3. Modelos compartimentais estruturados</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Séries de Fourier e Aplicações</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1101-Series_Fourier">11.1. Séries de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1102-Transformada_discreta_Fourier">11.2. Transformada discreta de Fourier</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1103-Ondas_sonoras_elementos_musicais">11.3. Ondas sonoras e elementos musicais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/modelagem_matematica/pages/jupytered/c11/1104-Compressao_audio">11.4. Séries de Fourier e compressão de audio</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/modelagem_matematica/tree/modmat2022p1"><img src="/modelagem_matematica/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo"><kbd>→</kbd> 6.2. Validação de modelos</a>
</span>
    </p>
</div>
</br></br>

    

    
      <div class="badges">
<p>
<a href="https://nbviewer.org/urls/rmsrosa.github.io/modelagem_matematica/generated/jupytered/c06/0601-Qualidade_do_modelo.ipynb"><img align="left" src="https://img.shields.io/badge/view%20in-nbviewer-orange" alt="View in NBViewer" title="View Jupyter notebook in NBViewer"></a>
<a href="https://mybinder.org/v2/gh/rmsrosa/modelagem_matematica/julia-env-for-binder-2022p1?urlpath=git-pull%3Frepo%3Dhttps://github.com/rmsrosa/modelagem_matematica%26urlpath%3Dlab/tree%252Fmodelagem_matematica/generated/jupytered/c06/0601-Qualidade_do_modelo.ipynb%26branch%3Dgh-pages"><img align="left" src="https://mybinder.org/badge.svg" alt="Open in binder" title="Open in binder"></a>
<a href="/modelagem_matematica/generated/jupytered/c06/0601-Qualidade_do_modelo.ipynb"><img align="left" src="https://img.shields.io/badge/download-notebook-blue" alt="Download notebook" title="Download Jupyter notebook"></a>
<a href="/modelagem_matematica/src/jupyter/c06/0601-Qualidade_do_modelo.ipynb"><img align="left" src="https://img.shields.io/badge/view-source-lightblue" alt="View source" title="View source"></a>
</p>
</div></br>

    
<h1 id="get_title"><a href="#get_title" class="header-anchor">6.1. Qualidade do ajuste</a></h1>
<ul>
<li><p>Erros absolutos SS e RMS</p>
</li>
<li><p>Erros relativos baseados em SS e RMS</p>
</li>
<li><p>R-quadrado</p>
</li>
<li><p>R-quadrado ajustado</p>
</li>
</ul>
<pre><code class="language-julia">using Random
using Statistics
using LinearAlgebra
using Plots
theme&#40;:ggplot2&#41;</code></pre>
<h2 id="amostra_e_modelo"><a href="#amostra_e_modelo" class="header-anchor">Amostra e modelo</a></h2>
<p>Consideramos </p>
<ul>
<li><p>Uma <strong>amostra</strong> \( (x_i, y_i), i=1, \ldots, N\). </p>
</li>
<li><p>Um <strong>modelo</strong> \(y = f_\beta(x),\) com <strong>parâmetros</strong> \(\beta=(\beta_1, \ldots, \beta_m)\).</p>
</li>
<li><p><strong>Valores calculados pelo modelo:</strong> \(\hat y_i = f_\beta(x_i).\)</p>
</li>
<li><p><strong>Dados amostrais:</strong> \( (x_i, \hat y_i), i = 1, \ldots, N.\)</p>
</li>
</ul>
<h2 id="resíduos"><a href="#resíduos" class="header-anchor">Resíduos</a></h2>
<p>Os resíduos são dados pelas diferenças entre os dados da amostra e os do modelo:</p>
\[ r_i = y_i - f_\beta(x_i).
\]
<p>ou, com a notação \(\hat y_i = f(x_i)\),</p>
\[ r_i = y_i - \hat{y}_i.
\]
<h2 id="erros_absolutos_ss_e_rms"><a href="#erros_absolutos_ss_e_rms" class="header-anchor">Erros absolutos SS e RMS</a></h2>
<p>Duas maneiras naturais, e relacionadas, de calcular o erro de um modelo são:</p>
<ul>
<li><p><strong>SS dos resíduos</strong> ou <strong>soma dos quadrados dos resíduos</strong> &#40;sum of squares of residuals&#41;:</p>
</li>
</ul>
\[ \mathrm{SS}(\mathbf{r}) = \sum_{i=1}^N r_i^2 = \sum_i (y_i - \hat{y}_i)^2.
\]
<ul>
<li><p><strong>RMS dos resíduos</strong>  ou <strong>raiz quadrada da média dos quadrados dos resíduos</strong> &#40;root-mean-square of the residuals&#41;:</p>
</li>
</ul>
\[ \mathrm{RMS}(\mathbf{r}) = \sqrt{\frac{1}{N} \sum_{i=1}^N r_i^2} = \sqrt{\frac{1}{N} \sum_{i=1}^N(y_i - \hat{y}_i}).
\]
<p><strong>Observações:</strong></p>
<ul>
<li><p>Estes são erros <strong>absolutos</strong> do modelo.</p>
</li>
<li><p>\(\mathrm{SS}(\mathbf{r})\) depende &quot;fortemente&quot; do número de dados e pode crescer significativamente à medida em que os dados aumentam em número.</p>
</li>
<li><p>Temos </p>
</li>
</ul>
\[  \mathrm{RMS}(\mathbf{r}) = \sqrt{\frac{\mathrm{SS(\mathbf{r})}}{N}}.
\]
<ul>
<li><p>\(\mathrm{RMS}(\mathbf{r})\) tem a mesma grandeza que \(y_i\).</p>
</li>
</ul>
<h2 id="erros_relativos"><a href="#erros_relativos" class="header-anchor">Erros relativos</a></h2>
<p>Erros relativos podem ser obtidos dividindo os erros absolutos por alguma quantidade de mesma grandeza dos dados. No caso, podemos considerar</p>
<ul>
<li><p><strong>SS relativo:</strong></p>
</li>
</ul>
\[ \mathrm{SS}_\textrm{rel} = \frac{\mathrm{SS}(\mathbf{r})}{\mathrm{SS}(\mathbf{y})},
\]
<p>onde \(\mathrm{SS}(\mathbf{y}) = \sum_i y_i^2\).</p>
<ul>
<li><p><strong>RMS relativo dos resíduos</strong>:</p>
</li>
</ul>
\[ \mathrm{RMS}_\mathrm{rel} = \frac{\mathrm{RMS}(\mathbf{r})}{\mathrm{RMS}(\mathbf{y})},
\]
<p>onde \(\mathrm{RMS}(\mathbf{y}) = \sqrt{(1/N)\sum_i y_i^2}\).</p>
<p><strong>Observações:</strong></p>
<ul>
<li><p>É claro que os denominadores não podem se anular, mas eles so se anulam quando todos \(y_i=0\), sendo que, nesse caso, não há muito o que modelar.</p>
</li>
<li><p>\(\mathrm{SS}_\textrm{rel}\) não depende &quot;tão fortemente&quot; do número de amostras. </p>
</li>
<li><p>A relação entre \(\mathrm{SS}_\textrm{rel}\) e \(\mathrm{RMS}_\textrm{rel}\) não depende explicitamente do número de amostras:</p>
</li>
</ul>
\[ \mathrm{SS}_\textrm{rel} = \mathrm{RMS}_\textrm{rel}^2.
\]
<ul>
<li><p>Como \(\mathrm{RMS}\) tem a mesma grandeza que os valores &#40;e.g. comprimento, velocidade, massa, população, moeda&#41;, então \(\mathrm{RMS}_{\text{rel}}\) é mais natural para expressar o erro relativo.</p>
</li>
<li><p>Por exemplo, se \(\mathrm{RMS}_\textrm{rel} \approx 0.1\), podemos dizer que o modelo nos dá uma aproximação, dos dados da amostra, da ordem de 10&#37;.</p>
</li>
</ul>
<h2 id="r-quadrado"><a href="#r-quadrado" class="header-anchor">R-quadrado</a></h2>
<p>Uma outra quantidade relativa usada para medir a qualidade de um modelo é o chamado <strong>R quadrado</strong>, ou \(R^2\), comparando relativamente o modelo e os dados da amostra em relação ao valor médio dos dados. Considera-se</p>
<ul>
<li><p>A <strong>média dos valores dos dados</strong> da amostra:</p>
</li>
</ul>
\[ \bar y = \frac{1}{N} \sum_{i=1}^N y_i.
\]
<ul>
<li><p><strong>Soma dos quadrados total em relação à média</strong> &#40;que é proporcional à variância total&#41;, medindo, de certa forma, o erro em se aproximar a amostragem por um valor constante igual à média dos dados:</p>
</li>
</ul>
\[ \mathrm{SS}_\mathrm{tot} = \sum_{i=1}^N (y_i - \bar y)^2 = N \mathrm{Var}(y_i).
\]
<ul>
<li><p><strong>Soma dos quadrados da regressão em relação à media</strong>,  medindo, de certa forma, a diferença entre o modelo ajustado e a média dos dados:</p>
</li>
</ul>
\[ \mathrm{SS}_\mathrm{reg} = \sum_{i=1}^N (\hat y_i - \bar y)^2.
\]
<ul>
<li><p><strong>R-quadrado,</strong> comparando </p>
</li>
</ul>
\[ R^2 = \frac{\mathrm{SS}_\mathrm{reg}}{\mathrm{SS}_\mathrm{tot}}.
\]
<h2 id="r-quadrado_em_regressão_via_mínimos_quadrados"><a href="#r-quadrado_em_regressão_via_mínimos_quadrados" class="header-anchor">R-quadrado em regressão via mínimos quadrados</a></h2>
<ul>
<li><p>Suponha que</p>
<ol>
<li><p>O modelo \(f_\beta = f_\beta(x)\) seja linear nos parâmetros \(\beta\);</p>
</li>
<li><p>A média \(\bar y\) possa ser descrita pelo modelo com uma escolha apropriada \(\bar\beta\) dos parâmetros, com \(\bar y = f_{\bar\beta}(x)\) independente de \(x\); e</p>
</li>
<li><p>O ajuste seja feito minimizando-se o erro quadrático dos resíduos,</p>
</li>
</ol>
</li>
<li><p>Nesse caso, vale a relação </p>
</li>
</ul>
\[ \mathrm{SS}_\mathrm{reg} = \mathrm{SS}_\mathrm{tot} - \mathrm{SS}_\mathrm{res},
\]
<p>onde \(\mathrm{SS}_\mathrm{res} = \mathrm{SS}(\mathbf{r}) = \sum_{i=1}^N (y_i - \hat{y}_i)^2\).</p>
<ul>
<li><p>Isso nos leva à formula mais conhecida</p>
</li>
</ul>
\[ R^2 = 1 - \frac{\mathrm{SS}_\mathrm{res}}{\mathrm{SS}_\mathrm{tot}},
\]
<ul>
<li><p>Como \(0 \leq \mathrm{SS}_\mathrm{res} \leq \mathrm{SS}_\mathrm{tot}\), então \(0 \leq R^2 \leq 1\).</p>
</li>
<li><p>Quanto mais próximo \(R^2\) estiver de 1, melhor será o ajuste.</p>
</li>
<li><p>\(R^2\) é uma medida da qualidade do ajuste.</p>
</li>
</ul>
<h2 id="r-quadrado_ajustado"><a href="#r-quadrado_ajustado" class="header-anchor">R-quadrado ajustado</a></h2>
<ul>
<li><p>Para compensar um pouco a influência do número de parâmetros, um <strong>R-quadrado ajustado</strong> \(R_\textrm{aj}^2\) é usado.</p>
</li>
<li><p>Temos, mais precisamente, o seguinte ajuste em relação ao número de parâmetros do modelo:</p>
</li>
</ul>
\[ R_\mathrm{aj}^2 = 1 - (1-R^2)\frac{N-1}{N-m},
\]
<p>onde \(N\) é o número de dados e \(m\) é o número de parâmetros.</p>
<h2 id="comparando_diferentes_modelos"><a href="#comparando_diferentes_modelos" class="header-anchor">Comparando diferentes modelos</a></h2>
<ul>
<li><p>Uma primeira medida de comparação entre diferentes modelos é comparar os valores correspondentes de algumas das quantidade vistas acima:</p>
<ul>
<li><p>RMS absoluto</p>
</li>
</ul>
<ul>
<li><p>RMS relativo</p>
</li>
</ul>
<ul>
<li><p>SS relativo</p>
</li>
</ul>
<ul>
<li><p>R-quadrado</p>
</li>
</ul>
<ul>
<li><p>R-quadrado ajustado</p>
</li>
</ul>
</li>
<li><p>A medida SS absoluta não é apropriada porque depende fortemente do número de dados.</p>
</li>
<li><p>A dependência dessas medidas em relação ao número de parâmetros também é um ponto delicado.</p>
</li>
</ul>
<h2 id="exemplo_sintético"><a href="#exemplo_sintético" class="header-anchor">Exemplo sintético</a></h2>
<p>Neste exemplo, vamos </p>
<ul>
<li><p>Construir dados sintéticos a partir de perturbações aleatórias em torno de uma determinada função.</p>
</li>
<li><p>Perturbações uniformemente distribuídas entre \(\pm 0.3\) na abscissa.</p>
</li>
<li><p>Perturbações uniformemente distribuídas entre \(\pm 1\) na ordenada.</p>
</li>
<li><p>Em seguida, usaremos mínimos quadrados para ajustar um polinômio de grau três.</p>
</li>
<li><p>Posteriormente, mínimos quadrados para ajustar polinômios de diversos graus.</p>
</li>
</ul>
<h3 id="definição_do_modelos_e_da_função_geradora_dos_dados"><a href="#definição_do_modelos_e_da_função_geradora_dos_dados" class="header-anchor">Definição do modelos e da função geradora dos dados</a></h3>
<pre><code class="language-julia"># f &#61; β₀ &#43; β₁x &#43; β₂x² &#43; … &#43; βᵢxⁱ
f_modelo&#40;x, β&#41; &#61; β ⋅ &#91;x^j for j in 0:length&#40;β&#41;-1&#93;
f_dados&#40;x,β&#41; &#61; exp&#40;β&#91;4&#93;*x&#41; * &#40;β&#91;1&#93; &#43; β&#91;2&#93;*x &#43; β&#91;3&#93;*x^2 &#43; β&#91;4&#93;*x^3&#41;
β̲ &#61; &#91;5.2, 0.5, -0.45, 0.05&#93;
x &#61; -1.0:0.1:8.0
nothing</code></pre>
<pre><code class="language-julia">plot&#40;x, x -&gt; f_dados&#40;x,β̲&#41;, label&#61;nothing, xlim&#61;&#40;-1,8&#41;, ylim&#61;&#40;1,9&#41;, legend&#61;false,
    titlefont&#61;10, title&#61;&quot;função para a geração da amostra&quot;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0601-Qualidade_do_modelo/code/images/0601-Qualidade_do_modelo_3_1.png" alt="">
<h3 id="gerando_os_dados_sintéticos"><a href="#gerando_os_dados_sintéticos" class="header-anchor">Gerando os dados sintéticos</a></h3>
<pre><code class="language-julia">dados_x &#61; collect&#40;0.0:8.0&#41; .&#43; 0.3 * randn&#40;MersenneTwister&#40;14003&#41;, 9&#41;
dados_y &#61; f_dados.&#40;dados_x, Ref&#40;β̲&#41;&#41; .&#43; randn&#40;MersenneTwister&#40;14004&#41;, 9&#41;
nothing</code></pre>
<pre><code class="language-julia">plot&#40;xlim&#61;&#40;-1,8&#41;, ylim&#61;&#40;1,9&#41;, legend&#61;:topleft,
    titlefont&#61;10, title&#61;&quot;função para a amostra e dados sintéticos&quot;&#41;
plot&#33;&#40;dados_x, dados_y, seriestype&#61;:scatter, label&#61;&quot;amostra&quot;&#41;
plot&#33;&#40;x, x -&gt; f_dados&#40;x,β̲&#41;, label&#61;&quot;função para a amostra&quot;&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0601-Qualidade_do_modelo/code/images/0601-Qualidade_do_modelo_5_1.png" alt="">
<h3 id="regressão_linear_via_mínimos_quadrados"><a href="#regressão_linear_via_mínimos_quadrados" class="header-anchor">Regressão linear via mínimos quadrados</a></h3>
<pre><code class="language-julia">A &#61; &#91;ones&#40;length&#40;dados_x&#41;&#41; dados_x dados_x.^2 dados_x.^3&#93;</code></pre>
<pre><code class="language-julia">9×4 Matrix&#123;Float64&#125;:
 1.0  0.0851634   0.0072528    0.000617673
 1.0  0.684559    0.468621     0.320799
 1.0  2.31975     5.38123     12.4831
 1.0  3.23412    10.4595      33.8274
 1.0  3.99424    15.954       63.724
 1.0  4.93406    24.345      120.12
 1.0  6.2438     38.985      243.415
 1.0  6.9403     48.1677     334.298
 1.0  7.98801    63.8083     509.701</code></pre>
<pre><code class="language-julia">β̂ &#61; A \ dados_y</code></pre>
<pre><code class="language-julia">4-element Vector&#123;Float64&#125;:
  5.58285349098757
  0.7068669251980298
 -0.5942506978954095
  0.07079991932172676</code></pre>
<h3 id="função_para_cálculo_das_medidas_de_qualidade_do_modelo"><a href="#função_para_cálculo_das_medidas_de_qualidade_do_modelo" class="header-anchor">Função para cálculo das medidas de qualidade do modelo</a></h3>
<pre><code class="language-julia">function info_ajuste&#40;dados_x, dados_y, model_y, k&#41;
    N &#61; length&#40;dados_x&#41;
    y_mean &#61; mean&#40;dados_y&#41;
    residuos &#61; model_y - dados_y
    ss &#61; norm&#40;residuos&#41;^2
    rms &#61; sqrt&#40;ss/N&#41;
    ss_y &#61; norm&#40;dados_y&#41;^ 2
    rms_y &#61; sqrt&#40;ss_y/N&#41;
    ss_rel &#61; ss/ss_y
    rms_rel &#61; sqrt&#40;ss_rel&#41;
    ss_tot &#61; N*var&#40;dados_y&#41;
    ss_reg &#61; norm&#40;model_y .- y_mean&#41;^2
    r_sq &#61; ss_reg/ss_tot
    r_sq_aj &#61; 1 - &#40;1 - r_sq&#41;*&#40;N-1&#41;/&#40;N-k&#41;
    
    return &#40;
        residuos&#61;residuos, rms&#61;rms, rms_rel&#61;rms_rel, ss&#61;ss, ss_rel&#61;ss_rel,
        r_sq&#61;r_sq, r_sq_aj&#61;r_sq_aj
    &#41;
end</code></pre>
<pre><code class="language-julia">info_ajuste &#40;generic function with 1 method&#41;</code></pre>
<h3 id="resultado"><a href="#resultado" class="header-anchor">Resultado</a></h3>
<pre><code class="language-julia">info &#61; info_ajuste&#40;dados_x, dados_y, f_modelo.&#40;dados_x,Ref&#40;β̂&#41;&#41;, length&#40;β̂&#41;&#41;

println&#40;&quot;RMS dos resíduos: &#36;&#40;info.rms&#41;&quot;&#41;
println&#40;&quot;RMS relativo: &#36;&#40;info.rms_rel&#41;&quot;&#41;
println&#40;&quot;Baseado no RMS relativo, o modelo nos dá uma aproximação de &#36;&#40;100*info.rms_rel&#41;&#37; dos dados&quot;&#41;
println&#40;&quot;SS dos resíduos: &#36;&#40;info.ss&#41;&quot;&#41;
println&#40;&quot;SS relativo: &#36;&#40;info.ss_rel&#41;&#125;&quot;&#41;
println&#40;&quot;R-quadrado: &#36;&#40;info.r_sq&#41;&quot;&#41;
println&#40;&quot;R-quadrado ajustado: &#36;&#40;info.r_sq_aj&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">RMS dos resíduos: 0.5796526627862785
RMS relativo: 0.10662332249595524
Baseado no RMS relativo, o modelo nos dá uma aproximação de 10.662332249595
524&#37; dos dados
SS dos resíduos: 3.023974885277007
SS relativo: 0.011368532900076474&#125;
R-quadrado: 0.803366892196622
R-quadrado ajustado: 0.6853870275145952</code></pre>
<pre><code class="language-julia">plot&#40;titlefont&#61;10, title&#61;&quot;Modelo ajustado e dados sintéticos&quot;, legend&#61;:topleft,
    xlim&#61;&#40;-1,8&#41;, ylim&#61;&#40;1,9&#41;&#41;
plot&#33;&#40;dados_x, dados_y, seriestype&#61;:scatter, label&#61;&quot;amostra&quot;&#41;
plot&#33;&#40;x,x-&gt;f_modelo&#40;x,β̂&#41;, label&#61;&quot;modelo ajustado 1 &#40;R² &#61; &#36;&#40;round&#40;info.r_sq,digits&#61;3&#41;&#41;, &quot; * 
    &quot;R²_aj &#61; &#36;&#40;round&#40;info.r_sq_aj,digits&#61;3&#41;&#41;, RMS_rel &#61; &#36;&#40;round&#40;info.rms_rel,digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0601-Qualidade_do_modelo/code/images/0601-Qualidade_do_modelo_10_1.png" alt="">
<h2 id="aumentando_o_número_de_dados"><a href="#aumentando_o_número_de_dados" class="header-anchor">Aumentando o número de dados</a></h2>
<pre><code class="language-julia">dados_novos_x &#61; collect&#40;0.5:8.5&#41; .&#43; 0.3 * randn&#40;MersenneTwister&#40;14005&#41;, 9&#41;
dados_novos_y &#61; f_dados.&#40;dados_x, Ref&#40;β̲&#41;&#41; .&#43; randn&#40;MersenneTwister&#40;14006&#41;, 9&#41;
dados2_x &#61; reshape&#40;&#91;dados_x&#39;; dados_novos_x&#39;&#93;,:,1&#41;
dados2_y &#61; reshape&#40;&#91;dados_y&#39;; dados_novos_y&#39;&#93;,:,1&#41;
nothing</code></pre>
<pre><code class="language-julia">A2 &#61; &#91;ones&#40;length&#40;dados2_x&#41;&#41; dados2_x dados2_x.^2 dados2_x.^3&#93;
β̂2 &#61; A2 \ dados2_y</code></pre>
<pre><code class="language-julia">4×1 Matrix&#123;Float64&#125;:
  5.8277427790137155
  0.15311793108645264
 -0.35223469770266713
  0.04515333070990545</code></pre>
<h2 id="dados_da_análise"><a href="#dados_da_análise" class="header-anchor">Dados da análise</a></h2>
<pre><code class="language-julia">info2 &#61; info_ajuste&#40;dados2_x, dados2_y, f_modelo.&#40;dados2_x,Ref&#40;β̂2&#41;&#41;, length&#40;β̂2&#41;&#41;

println&#40;&quot;RMS dos resíduos: &#36;&#40;info2.rms&#41;&quot;&#41;
println&#40;&quot;RMS relativo: &#36;&#40;info2.rms_rel&#41;&quot;&#41;
println&#40;&quot;Baseado no RMS relativo, o modelo nos dá uma aproximação de &#36;&#40;100*info2.rms_rel&#41;&#37; dos dados&quot;&#41;
println&#40;&quot;SS dos resíduos: &#36;&#40;info2.ss&#41;&quot;&#41;
println&#40;&quot;SS relativo: &#36;&#40;info2.ss_rel&#41;&#125;&quot;&#41;
println&#40;&quot;R-quadrado: &#36;&#40;info2.r_sq&#41;&quot;&#41;
println&#40;&quot;R-quadrado ajustado: &#36;&#40;info2.r_sq_aj&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">RMS dos resíduos: 0.8522086357821341
RMS relativo: 0.1593346115310878
Baseado no RMS relativo, o modelo nos dá uma aproximação de 15.933461153108
78&#37; dos dados
SS dos resíduos: 13.072672060229628
SS relativo: 0.02538751843176266&#125;
R-quadrado: 0.7237391241568886
R-quadrado ajustado: 0.6645403650476505</code></pre>
<pre><code class="language-julia">plot&#40;titlefont&#61;10, title&#61;&quot;Modelos ajustados e dados sintéticos&quot;, 
    xlim&#61;&#40;-1,8&#41;, ylim&#61;&#40;1,9&#41;, legend&#61;:topleft&#41;
plot&#33;&#40;dados2_x, dados2_y, seriestype&#61;:scatter, label&#61;&quot;amostra 2&quot;&#41;
plot&#33;&#40;dados_x, dados_y, markersize&#61;2, seriestype&#61;:scatter, label&#61;&quot;amostra 1&quot;, color&#61;:orange&#41;
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂&#41;, label&#61;&quot;modelo ajustado 1 &#40;R² &#61; &#36;&#40;round&#40;info.r_sq, digits&#61;3&#41;&#41;, &quot; *
    &quot;R²_aj &#61; &#36;&#40;round&#40;info.r_sq_aj, digits&#61;3&#41;&#41;, RMS_rel &#61; &#36;&#40;round&#40;info.rms_rel, digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;  
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂2&#41;, label&#61;&quot;modelo ajustado 2 &#40;R² &#61; &#36;&#40;round&#40;info2.r_sq_aj, digits&#61;3&#41;&#41;, &quot; *
    &quot;R²_aj &#61; &#36;&#40;round&#40;info2.r_sq_aj,digits&#61;3&#41;&#41;, RMS_rel &#61; &#36;&#40;round&#40;info2.rms_rel, digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0601-Qualidade_do_modelo/code/images/0601-Qualidade_do_modelo_14_1.png" alt="">
<h2 id="ajuste_com_polinômios_de_grau_mais_alto"><a href="#ajuste_com_polinômios_de_grau_mais_alto" class="header-anchor">Ajuste com polinômios de grau mais alto</a></h2>
<pre><code class="language-julia">A3 &#61; reduce&#40;hcat, &#91;dados_x.^j for j&#61;0:8&#93;&#41;</code></pre>
<pre><code class="language-julia">9×9 Matrix&#123;Float64&#125;:
 1.0  0.0851634   0.0072528  …       3.24915e-8      2.76709e-9
 1.0  0.684559    0.468621           0.0704495       0.0482268
 1.0  2.31975     5.38123          361.481         838.544
 1.0  3.23412    10.4595          3700.78        11968.8
 1.0  3.99424    15.954          16219.6         64785.0
 1.0  4.93406    24.345      …   71192.4             3.51268e5
 1.0  6.2438     38.985         369950.0             2.30989e6
 1.0  6.9403     48.1677             7.75614e5       5.38299e6
 1.0  7.98801    63.8083             2.07525e6       1.65771e7</code></pre>
<pre><code class="language-julia">β̂3 &#61; A3 \ dados_y</code></pre>
<pre><code class="language-julia">9-element Vector&#123;Float64&#125;:
   5.480089368087107
  -0.13193193809904286
   7.443460411397602
 -12.974325526375585
   8.319509808076305
  -2.613748308967248
   0.4320196312510229
  -0.036062570034203024
   0.001199219931939132</code></pre>
<h3 id="resultado__2"><a href="#resultado__2" class="header-anchor">Resultado</a></h3>
<pre><code class="language-julia">info3 &#61; info_ajuste&#40;dados_x, dados_y, f_modelo.&#40;dados_x, Ref&#40;β̂3&#41;&#41;, length&#40;β̂3&#41;&#41;

println&#40;&quot;RMS dos resíduos: &#36;&#40;info3.rms&#41;&quot;&#41;
println&#40;&quot;RMS relativo: &#36;&#40;info3.rms_rel&#41;&quot;&#41;
println&#40;&quot;SS dos resíduos: &#36;&#40;info3.ss&#41;&quot;&#41;
println&#40;&quot;SS relativo: &#36;&#40;info3.ss_rel&#41;&#125;&quot;&#41;
println&#40;&quot;R-quadrado: &#36;&#40;info3.r_sq&#41;&quot;&#41;
println&#40;&quot;R-quadrado ajustado: &#36;&#40;info3.r_sq_aj&#41;&quot;&#41;</code></pre>
<pre><code class="language-julia">RMS dos resíduos: 1.0864081316586043e-11
RMS relativo: 1.998376821513424e-12
SS dos resíduos: 1.0622543656805452e-21
SS relativo: 3.993509920762095e-24&#125;
R-quadrado: 0.8888888888838526
R-quadrado ajustado: -Inf</code></pre>
<pre><code class="language-julia">plot&#40;titlefont&#61;10, title&#61;&quot;Modelos ajustados e dados sintéticos&quot;, legend&#61;:topleft,
    xlim&#61;&#40;-1,8&#41;, ylim&#61;&#40;1,9&#41;&#41;
plot&#33;&#40;dados2_x, dados2_y, seriestype&#61;:scatter, label&#61;&quot;amostra 2&quot;&#41;
plot&#33;&#40;dados_x, dados_y, markersize&#61;2, seriestype&#61;:scatter, label&#61;&quot;amostra 1&quot;, color&#61;:orange&#41;
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂&#41;,
    label&#61;&quot;modelo ajustado 1 &#40;R² &#61; &#36;&#40;round&#40;info.r_sq, digits&#61;3&#41;&#41;, &quot; * 
    &quot;R²_aj &#61; &#36;&#40;round&#40;info.r_sq_aj, digits&#61;3&#41;&#41;, RMS_rel &#61; &#36;&#40;round&#40;info.rms_rel, digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂2&#41;,
    label&#61;&quot;modelo ajustado 2 &#40;R² &#61; &#36;&#40;round&#40;info2.r_sq, digits&#61;3&#41;&#41;, &quot; * 
    &quot;R²_aj &#61; &#36;&#40;round&#40;info2.r_sq_aj, digits&#61;3&#41;&#41;, RMS_rel &#61; &#36;&#40;round&#40;info2.rms_rel, digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;
plot&#33;&#40;x, x -&gt; f_modelo&#40;x, β̂3&#41;,
    label&#61;&quot;modelo ajustado 3 &#40;R² &#61; &#36;&#40;round&#40;info3.r_sq, digits&#61;3&#41;&#41;, &quot; * 
    &quot;R²_aj &#61; &#36;&#40;round&#40;info3.r_sq_aj, digits&#61;3&#41;&#41;, RMS_rel &#61; &#36;&#40;round&#40;info3.rms_rel, digits&#61;3&#41;&#41;&#41;&quot;,
    linestyle&#61;:dash&#41;</code></pre>
<img src="/modelagem_matematica/assets/pages/jupytered/c06/0601-Qualidade_do_modelo/code/images/0601-Qualidade_do_modelo_18_1.png" alt="">
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Mostre a relação \(\mathrm{SS}_\text{reg} = \mathrm{SS}_\text{tot} - \mathrm{SS}_\text{res}\) sob as condições mencionadas no texto, i.e:</p>
<ol>
<li><p>O modelo \(f_\beta = f_\beta(x)\) é linear nos parâmetros \(\beta\);</p>
</li>
<li><p>A média \(\bar y\) pode ser descrita pelo modelo com uma escolha apropriada \(\bar\beta\) dos parâmetros, com \(\bar y = f_{\bar\beta}(x)\) independente de \(x\); e</p>
</li>
<li><p>O ajuste é feito minimizando-se o erro quadrático dos resíduos,</p>
</li>
</ol>
</li>
<li><p>Calcule os fatores de qualidade de ajuste, discutidos acima, das modelagens feitas nos exercícios do caderno 8, sobre <strong>Modelos redutíveis ao caso linear nos parâmetros e aplicações</strong>.</p>
</li>
<li><p>Sobre o problema de modelagem de reação enzimática em fígados de porcos, também discutido no caderno 8, considere ainda ajustes por modelos polinomiais de diferentes ordens e calcule os respectivos fatores de qualidade de ajuste.</p>
</li>
</ol>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c05/0503-Propagacao_incertezas">5.3. Propagação de incertezas <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/modelagem_matematica/pages/jupytered/c06/0602-Validacao_do_modelo"><kbd>→</kbd> 6.2. Validação de modelos</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            
        </div>
    

    Last modified: June 21, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/modelagem_matematica/libs/katex/katex.min.js"></script>
        <script src="/modelagem_matematica/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/modelagem_matematica/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
